import{a3 as R,d as A,l as M,o as i,c as s,t as y,b as r,C as $,h,a4 as H,a5 as U,z as c,a2 as B,a0 as j,F as V,L as N,a6 as Y,p as Z,H as G,M as J,N as P}from"./framework.60ec2bf9.js";const Q=["href"],X=A({__name:"ontology-annotation.ce",props:{annotation:null},setup(e){const m=e,w=M(()=>m.annotation?m.annotation.split("	")[0]:""),t=M(()=>m.annotation?m.annotation.split("	")[2]:""),o=M(()=>m.annotation?m.annotation.split("	")[1]:"");return(C,I)=>e.annotation&&e.annotation!=""?(i(),s("a",{key:0,href:r(t),target:"_blank"},y(r(o))+": "+y(r(w)),9,Q)):$("",!0)}}),ee={class:"auto-search-wrapper"},te={key:0},ae=["onInput","placeholder"],oe={key:1},ne={key:2,class:"auto-results-wrapper auto-is-active"},le={tabindex:"0",role:"listbox"},re=["onClick"],ie=["innerHTML"],se=["innerHTML"],de={key:3,type:"button","aria-label":"clear the search query"},ue=A({__name:"ontology-autocomplete.ce",props:{label:{type:String,required:!1,default:""},info:{type:String,required:!1,default:""},placeholder:{type:String,required:!1,default:""},ontologies:{type:String,required:!1,default:""},format:{type:String,required:!1,default:"text"}},emits:["change"],setup(e,{emit:m}){const w=e;let t=h(""),o=h([]);async function C(){if(t.value==="")return o.value=[],[];let f=t.value.indexOf(":"),v="",b=null;f<0?(v=w.ontologies,b=t.value):(b=t.value.split(":")[1],v=t.value.split(":")[0]);const x="https://service.tib.eu/ts4tib/api/select?q=",q=encodeURI("&ontology="+v+"&fieldList=iri,label,short_form,obo_id,ontology_name,ontology_prefix,description,type&obsoletes=false&local=false&rows=10");(await fetch(`${x}${b}${q}`)).json().then(E=>{o.value=E.response.docs})}function I(f){return t.value?f.replace(new RegExp(t.value,"gi"),v=>'<span class="highlightText">'+v+"</span>"):f}function u(f){return f?f.join(""):""}let n=h(null);const _=M(()=>n.value?w.format&&w.format=="json"?n.value:n.value?n.value.label+"	"+n.value.ontology_prefix+"	"+n.value.iri+"	"+n.value.type:"":null),S=f=>{n.value=f,t.value=f.label,m("change",_.value),o.value=[]};return(f,v)=>(i(),s("div",ee,[e.label?(i(),s("label",te,y(e.label),1)):$("",!0),H(c("input",{type:"text",id:"search","onUpdate:modelValue":v[0]||(v[0]=b=>B(t)?t.value=b:t=b),onInput:j(C,["stop"]),placeholder:e.placeholder,autocomplete:"off"},null,40,ae),[[U,r(t)]]),e.info&&r(o).length==0?(i(),s("p",oe,y(e.info),1)):(i(),s("div",ne,[c("ul",le,[(i(!0),s(V,null,N(r(o),b=>(i(),s("li",{key:b.short_label,role:"option",tabindex:"-1","aria-selected":"false","aria-setsize":"3","aria-posinset":"0",onClick:x=>S(b)},[c("p",{innerHTML:I(b.label)},null,8,ie),c("p",null,[c("small",{innerHTML:u(b.description)},null,8,se)]),c("small",null,y(b.ontology_prefix)+":"+y(b.iri),1)],8,re))),128))])])),r(t)!=""&&r(o).length>0?(i(),s("button",de)):$("",!0)]))}}),pe=`[data-v-d4fc57ea]:root{--close-button: url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath d='M18.984 6.422 13.406 12l5.578 5.578-1.406 1.406L12 13.406l-5.578 5.578-1.406-1.406L10.594 12 5.016 6.422l1.406-1.406L12 10.594l5.578-5.578z'/%3E%3C/svg%3E");--loupe-icon: url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath fill='%23929292' d='M16.041 15.856a.995.995 0 0 0-.186.186A6.97 6.97 0 0 1 11 18c-1.933 0-3.682-.782-4.95-2.05S4 12.933 4 11s.782-3.682 2.05-4.95S9.067 4 11 4s3.682.782 4.95 2.05S18 9.067 18 11a6.971 6.971 0 0 1-1.959 4.856zm5.666 4.437-3.675-3.675A8.967 8.967 0 0 0 20 11c0-2.485-1.008-4.736-2.636-6.364S13.485 2 11 2 6.264 3.008 4.636 4.636 2 8.515 2 11s1.008 4.736 2.636 6.364S8.515 20 11 20a8.967 8.967 0 0 0 5.618-1.968l3.675 3.675a.999.999 0 1 0 1.414-1.414z'/%3E%3C/svg%3E")}.auto-search-wrapper[data-v-d4fc57ea]{display:block;position:relative;width:100%}.auto-search-wrapper p[data-v-d4fc57ea]{margin:0;padding:0;font-size:1.1em}.auto-search-wrapper p .highlightText[data-v-d4fc57ea]{font-weight:700}.auto-search-wrapper input[data-v-d4fc57ea]{border:1px solid #d7d7d7;box-shadow:none;box-sizing:border-box;font-size:16px;padding:12px 45px 12px 10px;width:100%}.auto-search-wrapper input[data-v-d4fc57ea]:focus{border:1px solid #858585;outline:none}.auto-search-wrapper input[data-v-d4fc57ea]::-ms-clear{display:none}.auto-search-wrapper ul[data-v-d4fc57ea]{list-style:none;margin:0;overflow:auto;padding:0}.auto-search-wrapper ul li[data-v-d4fc57ea]{cursor:pointer;margin:0;overflow:hidden;padding:10px;position:relative;border:1px dotted #f1f1f2}.auto-search-wrapper ul li[data-v-d4fc57ea]:hover{background-color:#f1f1f2}.auto-search-wrapper ul li[data-v-d4fc57ea]:not(:last-child){border-top:none}.auto-search-wrapper ul li[disabled][data-v-d4fc57ea]{background:#ececec;opacity:.5;pointer-events:none}.auto-search-wrapper .auto-expanded[data-v-d4fc57ea]{border:1px solid #858585;outline:none}.auto-search-wrapper.loupe[data-v-d4fc57ea]:before{filter:invert(60%)}.auto-is-loading[data-v-d4fc57ea]:after{animation:auto-spinner-d4fc57ea .6s linear infinite;border-color:#d9d9d9 grey grey #d9d9d9;border-radius:50%;border-style:solid;border-width:2px;bottom:0;box-sizing:border-box;content:"";height:20px;margin:auto;position:absolute;right:10px;top:0;width:20px}.auto-is-loading .auto-clear[data-v-d4fc57ea]{display:none}@keyframes auto-spinner-d4fc57ea{to{transform:rotate(1turn)}}li.loupe[data-v-d4fc57ea]:before{bottom:auto;top:15px}.loupe input[data-v-d4fc57ea]{padding:12px 45px 12px 35px}.loupe[data-v-d4fc57ea]:before{background-image:var(--loupe-icon);bottom:0;content:"";height:17px;left:10px;margin:auto;position:absolute;top:0;width:17px}.auto-selected[data-v-d4fc57ea]:before{opacity:1}.auto-clear[data-v-d4fc57ea]{align-items:center;background-color:transparent;border:none;bottom:0;cursor:pointer;display:flex;height:auto;justify-content:center;margin:auto;position:absolute;right:0;top:0;width:40px}.auto-clear[data-v-d4fc57ea]:before{content:var(--close-button);height:24px;line-height:100%;width:24px}.auto-clear span[data-v-d4fc57ea]{display:none}.auto-results-wrapper[data-v-d4fc57ea]{background-color:#fff;border:1px solid #858585;border-top:none;box-sizing:border-box;display:none;overflow:hidden}.auto-results-wrapper ul>.loupe[data-v-d4fc57ea]{padding-left:40px}.auto-results-wrapper.auto-is-active[data-v-d4fc57ea]{display:block;margin-top:-1px;position:absolute;width:100%;z-index:99999}.auto-selected[data-v-d4fc57ea]{background-color:#e6e6e6}.auto-selected+li[data-v-d4fc57ea]:before{border-top:none}.auto-error[data-v-d4fc57ea]{border:1px solid #ff3838}.auto-error[data-v-d4fc57ea]::placeholder{color:#f66;opacity:1}.hidden[data-v-d4fc57ea]{display:none}
`,O=(e,m)=>{const w=e.__vccOpts||e;for(const[t,o]of m)w[t]=o;return w},ce=O(ue,[["styles",[pe]],["__scopeId","data-v-d4fc57ea"]]),fe=e=>(J("data-v-bc5db457"),e=e(),P(),e),ve=["id"],ge={key:0,class:"o_annotate_label"},be={key:1},xe={key:2},he={key:0,class:"contextmenu_item"},ye={key:1},me=["onClickCapture"],we=["innerHTML"],_e={key:0,style:{float:"right"}},ke=fe(()=>c("i",null,"...loading",-1)),Se=[ke],Ce={key:0},$e=A({__name:"ontology-annotate.ce",props:{label:{type:String,required:!1,default:""},info:{type:String,required:!1,default:""},placeholder:{type:String,required:!1,default:""},ontologies:{type:String,required:!1,default:""},format:{type:String,required:!1,default:"text"}},emits:["change"],setup(e,{emit:m}){const w=e,t=(Math.random()+1).toString(36).substring(7),o=h(null),C=h(!1);let I=h(""),u=h({x:-1e3,y:0,start:-1,end:-1}),n=h(""),_=h(!1),S=h([]),f=Y([]);const v=new WeakMap,b=M(()=>"left:"+u.value.x+"px; top:"+u.value.y+"px"),x=M(()=>{var g;let a=C?(g=o.value)==null?void 0:g.value:I.value;return a?w.format&&w.format=="json"?{text:a,ontology:f}:a+`
$$$$
`+f.map(l=>l.ontology.type[0]+"	"+l.ontology.ontology_prefix+" "+l.context.start+" "+l.context.end+"	"+l.ontology.label+"	"+l.ontology.iri).join(`
`):null});Z(()=>{var a=document.getElementsByTagName("ontology-annotate")[0];a!=null&&a.shadowRoot&&(C.value=!0)});function q(a){I.value=a.target.innerText,m("change",x.value)}function E(a){var l,k;let g={ontology:{},context:{}};if(!C)g={ontology:a,context:u.value};else if(o){let d={x:0,y:0,start:(l=o.value)==null?void 0:l.selectionStart,end:(k=o.value)==null?void 0:k.selectionEnd};g={ontology:a,context:d}}f.push(g),S.value=[],n.value="",m("change",x.value)}function L(a){if(n.value="",window.getSelection){var g=window.getSelection();n.value=g==null?void 0:g.toString(),n.value&&n.value!=""?(S.value=[],D(g),T(a)):(u.value={x:-1e3,y:0,start:-1,end:-1},S.value=[])}}function D(a,g=!0){var d;if(!(a!=null&&a.rangeCount))return null;let l=a.getRangeAt(0).cloneRange();if(!l.getClientRects)return null;l.collapse(g);let k=l.getClientRects();if(k.length<=0)u.value.x=0,u.value.y=0;else{let p=k[0];u.value.start=a.anchorOffset,u.value.end=a.focusOffset,u.value.x=p.x,u.value.y=p.y+((d=k[0])==null?void 0:d.height)}}async function T(a){if(n.value==="")return S.value=[],[];let g=n.value.indexOf(":"),l="",k=null;g<0?(l=w.ontologies,k=n.value):(k=n.value.split(":")[1],l=n.value.split(":")[0]);const d=a.currentTarget,p=v.get(d);p&&p.abort();const z=new AbortController;v.set(d,z);const K="https://service.tib.eu/ts4tib/api/select?q=",F=encodeURI("&ontolog-y="+l+"&fieldList=iri,label,short_form,obo_id,ontology_name,ontology_prefix,description,type&obsoletes=false&local=false&rows=10");_.value=!0,(await fetch(`${K}${k}${F}`,{signal:z.signal})).json().then(W=>{v.delete(d),S.value=W.response.docs,_.value=!1})}return(a,g)=>(i(),s("div",{id:"o_annotate_wrapper_"+r(t),class:"o_annotate_wrapper"},[e.label?(i(),s("label",ge,y(e.label),1)):$("",!0),C.value?(i(),s("div",xe,[c("textarea",{ref_key:"o_annotate_textarea",ref:o,onMouseup:L,onKeyup:L,onInput:q,class:"o_annotate_textarea"},y(r(I)),545)])):(i(),s("div",be,[c("div",{onMouseup:L,onKeyup:L,onInput:q,class:"o_annotate_textarea",ref:"o_annotate_div",contenteditable:"true"},y(r(I)),545)])),r(n)!=""?(i(),s("div",{key:3,class:"contextmenu",style:G(r(b))},[r(S).length==0&&!r(_)?(i(),s("div",he,"No matches found")):(i(),s("div",ye,[(i(!0),s(V,null,N(r(S),l=>(i(),s("div",{class:"contextmenu_item",key:l.short_label,role:"option",tabindex:"_1",aria_selected:"false",aria_setsize:"3",aria_posinset:"0",onClickCapture:j(k=>E(l),["stop","prevent"])},[c("p",{innerHTML:l.label},null,8,we),c("small",null,y(l.ontology_prefix)+":"+y(l.short_form),1)],40,me))),128))]))],4)):$("",!0),c("div",null,[r(_)?(i(),s("div",_e,Se)):$("",!0),c("div",null,[e.info?(i(),s("span",Ce,y(e.info),1)):$("",!0)])])],8,ve))}}),ze=`.o_annotate_textarea[data-v-bc5db457]{min-height:100px;border:1px solid #d7d7d7;box-shadow:none;box-sizing:border_box;padding:12px 45px 12px 10px;width:100%}#mainInput[data-v-bc5db457]{background:transparent;color:#000;opacity:1}.contextmenu[data-v-bc5db457]{position:absolute;top:0;right:0;background:#ffffff;color:#000;border:1px solid #f1f1f2;width:15rem;max-width:calc(100vw _ 2rem);max-height:300px;overflow-y:scroll;overflow-x:hidden;z-index:100;box-shadow:0 .5rem 1.5rem #0003;border-radius:.2rem}.contextmenu .contextmenu_item[data-v-bc5db457]{border-bottom:1px solid #c3c3c3;padding:8px}.contextmenu .contextmenu_item[data-v-bc5db457]:hover{cursor:pointer;background-color:#f1f1f2}.contextmenu .contextmenu_item p[data-v-bc5db457]{margin:0;padding:0}.contextmenu .contextmenu_item .iri[data-v-bc5db457]{margin:0;width:15rem;white-space:nowrap;text-overflow:ellipsis;word-wrap:break_word;padding:0}
`,Ie=O($e,[["styles",[ze]],["__scopeId","data-v-bc5db457"]]),Me={key:0},qe=["onKeyup","onChange"],Ee={key:1},Le={key:2},Te={key:3},je=A({__name:"ontology-compose.ce",props:{label:{type:String,required:!1,default:""},info:{type:String,required:!1,default:""},placeholder:{type:String,required:!1,default:""},format:{type:String,required:!1,default:"text"}},emits:["change"],setup(e,{emit:m}){const w=e;let t=h(""),o=h(""),C=-1,I=100,u=0,n=h([]),_="",S="",f=!1,v=h([]),b=h([]),x=h(null);const q=M(()=>x.value?x.value?x.value.label+"	"+x.value.ontology_prefix+"	"+x.value.iri+"	"+x.value.type:"":null),E=M(()=>t.value?w.format&&w.format=="json"?{text:t.value,ontology:v.value}:t.value+`
$$$$
`+v.value.join(`
`):null);async function L(d){if(t.value==""){o.value="";return}if(C>-1&&clearTimeout(C),d.key=="ArrowDown"){u==9&&T(),u+=1,k(),d.preventDefault();return}else if(d.key=="ArrowUp"){u==0&&T(),u-=1,k(),d.preventDefault();return}else if(d.key=="ArrowRight")d.preventDefault(),g();else if(t.value){let p=t.value.split(" ");p.length>1?(_=p.slice(-1)[0],S=p.slice(-2).join(" ")):(_=p[0],S=_),_==""&&(f=!1,x.value=null,o.value=t.value),f&&(_=S),a()}}function D(){m("change",E.value)}function T(){f=!0,_=S,u=0,a()}function a(){C=setTimeout(function(){l()},I)}function g(){t.value=o.value,v.value.push(q.value),b.value.push(x.value)}async function l(){const d="https://service.tib.eu/ts4tib/api/select?q=",p=encodeURI("&obsoletes=false&local=false&rows=10");(await fetch(`${d}${_}${p}`)).json().then(z=>{n.value=z.response.docs,n.value.length>0&&(u=0,k())})}function k(){let d="";x.value=n.value[u],d=x.value.label;let p=d.toLowerCase().replace(_,"");p!=null&&(o.value=t.value+p)}return(d,p)=>(i(),s("div",null,[e.label?(i(),s("label",Me,y(e.label),1)):$("",!0),c("div",null,[H(c("textarea",{"onUpdate:modelValue":p[0]||(p[0]=z=>B(o)?o.value=z:o=z),id:"autocomplete",type:"text",class:"o_annotate_textarea",line:"10"},null,512),[[U,r(o)]]),H(c("textarea",{id:"mainInput",onKeyup:j(L,["stop"]),onChange:j(D,["stop"]),"onUpdate:modelValue":p[1]||(p[1]=z=>B(t)?t.value=z:t=z),type:"text",class:"o_annotate_textarea"},null,40,qe),[[U,r(t)]])]),e.info&&r(n).length==0?(i(),s("p",Ee,y(e.info),1)):$("",!0),r(x)?(i(),s("span",Le,[c("code",null,[c("pre",null,y(r(q)),1)])])):$("",!0),r(v)&&r(v).length>0?(i(),s("span",Te,[c("code",null,[c("pre",null,y(r(E)),1)])])):$("",!0)]))}}),Re=`.o_annotate_textarea[data-v-c52caae7]{min-height:100px;border:1px solid #d7d7d7;box-shadow:none;box-sizing:border-box;padding:12px 45px 12px 10px;width:100%}#mainInput[data-v-c52caae7]{background:transparent;color:#000;opacity:100}#autocomplete[data-v-c52caae7]{position:absolute;box-sizing:border-box;cursor:text;pointer-events:none;color:#000;opacity:.6;background:transparent}
`,Ae=O(je,[["styles",[Re]],["__scopeId","data-v-c52caae7"]]),De=R(X),He=R(ce),Ue=R(Ie),Be=R(Ae);if(typeof window<"u"){let e=window.customElements;e.define("ontology-annotation",De),e.define("ontology-autocomplete",He),e.define("ontology-annotate",Ue),e.define("ontology-compose",Be)}
