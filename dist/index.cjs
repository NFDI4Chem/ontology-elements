"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const e=require("vue"),A=["href"],z=e.defineComponent({__name:"ontology-term-annotation.ce",props:{annotation:null},setup(t){const u=t,d=e.computed(()=>u.annotation?u.annotation.split("	")[0]:""),r=e.computed(()=>u.annotation?u.annotation.split("	")[2]:""),o=e.computed(()=>u.annotation?u.annotation.split("	")[1]:"");return(f,m)=>t.annotation&&t.annotation!=""?(e.openBlock(),e.createElementBlock("a",{key:0,href:e.unref(r),target:"_blank"},e.toDisplayString(e.unref(o))+": "+e.toDisplayString(e.unref(d)),9,A)):e.createCommentVNode("",!0)}}),L=["innerHTML"],j=e.defineComponent({__name:"ontology-text-annotation.ce",props:{annotation:null},setup(t){const u=t,d=e.computed(()=>u.annotation?u.annotation.split("$$$$")[0]:""),r=e.computed(()=>{let o=`${d.value}`,f=u.annotation?u.annotation.split("$$$$")[1].split(/\r?\n/).filter(a=>a):[],m=[];return f.forEach(a=>{let i=a.split("	"),g=i[1].split(" "),c={};c.value=o.substring(parseInt(g[1]),parseInt(g[2])),c.class=i[0],c.ontology=g[0],c.ontology_term=i[2],c.iri=i[3],m.push(c)}),m.forEach(a=>{o=o.replace(a.value,'<span class="o_term"><a target="_blank" href='+a.iri+">"+a.value+"</a></span>")}),o});return(o,f)=>(e.openBlock(),e.createElementBlock("div",{innerHTML:e.unref(r)},null,8,L))}}),R=`.o_term[data-v-922a42fb]{background-color:#cdcdcd;border-radius:4px;padding:1px 3px}
`,$=(t,u)=>{const d=t.__vccOpts||t;for(const[r,o]of u)d[r]=o;return d},H=$(j,[["styles",[R]],["__scopeId","data-v-922a42fb"]]),U={class:"auto-search-wrapper"},K={key:0},P=["onInput","placeholder"],W={key:1},F={key:2,class:"auto-results-wrapper auto-is-active"},J={tabindex:"0",role:"listbox"},G=["onClick"],Q=["innerHTML"],X=["innerHTML"],Y={key:3,type:"button","aria-label":"clear the search query"},Z=e.defineComponent({__name:"ontology-autocomplete.ce",props:{label:{type:String,required:!1,default:""},info:{type:String,required:!1,default:""},placeholder:{type:String,required:!1,default:""},ontologies:{type:String,required:!1,default:""},modelValue:{type:String,required:!1,default:""},styling:{type:String,required:!1,default:""},format:{type:String,required:!1,default:"text"}},emits:["change"],setup(t,{emit:u}){const d=t,r=l=>{m.value=l,o.value=l.label,u("change",a.value),f.value=[]};let o=e.ref(""),f=e.ref([]),m=e.ref(null);const a=e.computed(()=>m.value?d.format&&d.format=="json"?m.value:m.value?m.value.label+"	"+m.value.ontology_prefix+"	"+m.value.iri+"	"+m.value.type:"":null);e.watch(()=>d.modelValue,(l,h)=>{r(c(l))}),e.onMounted(()=>{d.modelValue!=""&&r(c(d.modelValue))});async function i(){if(o.value==="")return f.value=[],[];let l=o.value.indexOf(":"),h="",n=null;l<0?(h=d.ontologies,n=o.value):(n=o.value.split(":")[1],h=o.value.split(":")[0]);const w="https://service.tib.eu/ts4tib/api/select?q=",S=encodeURI("&ontology="+h+"&fieldList=iri,label,short_form,obo_id,ontology_name,ontology_prefix,description,type&obsoletes=false&local=false&rows=10");(await fetch(`${w}${n}${S}`)).json().then(B=>{f.value=B.response.docs})}function g(l){return o.value?l.replace(new RegExp(o.value,"gi"),h=>'<span class="highlightText">'+h+"</span>"):l}function c(l){if(!l)return null;const h=l.split("	");return{label:h[0],iri:h[2],ontology_prefix:h[1],type:h[3]}}function _(l){return l?l.join(""):""}return(l,h)=>(e.openBlock(),e.createElementBlock("div",U,[t.label?(e.openBlock(),e.createElementBlock("label",K,e.toDisplayString(t.label),1)):e.createCommentVNode("",!0),e.withDirectives(e.createElementVNode("input",{type:"text",id:"search","onUpdate:modelValue":h[0]||(h[0]=n=>e.isRef(o)?o.value=n:o=n),onInput:e.withModifiers(i,["stop"]),placeholder:t.placeholder,class:e.normalizeClass(t.styling),autocomplete:"off"},null,42,P),[[e.vModelText,e.unref(o)]]),t.info&&e.unref(f).length==0?(e.openBlock(),e.createElementBlock("p",W,e.toDisplayString(t.info),1)):(e.openBlock(),e.createElementBlock("div",F,[e.createElementVNode("ul",J,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(f),n=>(e.openBlock(),e.createElementBlock("li",{key:n.short_label,role:"option",tabindex:"-1","aria-selected":"false","aria-setsize":"3","aria-posinset":"0",onClick:w=>r(n)},[e.createElementVNode("p",{innerHTML:g(n.label)},null,8,Q),e.createElementVNode("p",null,[e.createElementVNode("small",{innerHTML:_(n.description)},null,8,X)]),e.createElementVNode("small",null,e.toDisplayString(n.ontology_prefix)+":"+e.toDisplayString(n.iri),1)],8,G))),128))])])),e.unref(o)!=""&&e.unref(f).length>0?(e.openBlock(),e.createElementBlock("button",Y)):e.createCommentVNode("",!0)]))}}),ee=`[data-v-c1d76900]:root{--close-button: url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath d='M18.984 6.422 13.406 12l5.578 5.578-1.406 1.406L12 13.406l-5.578 5.578-1.406-1.406L10.594 12 5.016 6.422l1.406-1.406L12 10.594l5.578-5.578z'/%3E%3C/svg%3E");--loupe-icon: url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath fill='%23929292' d='M16.041 15.856a.995.995 0 0 0-.186.186A6.97 6.97 0 0 1 11 18c-1.933 0-3.682-.782-4.95-2.05S4 12.933 4 11s.782-3.682 2.05-4.95S9.067 4 11 4s3.682.782 4.95 2.05S18 9.067 18 11a6.971 6.971 0 0 1-1.959 4.856zm5.666 4.437-3.675-3.675A8.967 8.967 0 0 0 20 11c0-2.485-1.008-4.736-2.636-6.364S13.485 2 11 2 6.264 3.008 4.636 4.636 2 8.515 2 11s1.008 4.736 2.636 6.364S8.515 20 11 20a8.967 8.967 0 0 0 5.618-1.968l3.675 3.675a.999.999 0 1 0 1.414-1.414z'/%3E%3C/svg%3E")}.auto-search-wrapper[data-v-c1d76900]{display:block;position:relative;width:100%}.auto-search-wrapper p[data-v-c1d76900]{margin:0;padding:0;font-size:1.1em}.auto-search-wrapper p .highlightText[data-v-c1d76900]{font-weight:700}.auto-search-wrapper input[data-v-c1d76900]{border:1px solid #d7d7d7;box-shadow:none;box-sizing:border-box;font-size:16px;padding:12px 45px 12px 10px;width:100%}.auto-search-wrapper input[data-v-c1d76900]:focus{border:1px solid #858585;outline:none}.auto-search-wrapper input[data-v-c1d76900]::-ms-clear{display:none}.auto-search-wrapper ul[data-v-c1d76900]{list-style:none;margin:0;overflow:auto;padding:0}.auto-search-wrapper ul li[data-v-c1d76900]{cursor:pointer;margin:0;overflow:hidden;padding:10px;position:relative;border:1px dotted #f1f1f2}.auto-search-wrapper ul li[data-v-c1d76900]:hover{background-color:#f1f1f2}.auto-search-wrapper ul li[data-v-c1d76900]:not(:last-child){border-top:none}.auto-search-wrapper ul li[disabled][data-v-c1d76900]{background:#ececec;opacity:.5;pointer-events:none}.auto-search-wrapper .auto-expanded[data-v-c1d76900]{border:1px solid #858585;outline:none}.auto-search-wrapper.loupe[data-v-c1d76900]:before{filter:invert(60%)}.auto-is-loading[data-v-c1d76900]:after{animation:auto-spinner-c1d76900 .6s linear infinite;border-color:#d9d9d9 grey grey #d9d9d9;border-radius:50%;border-style:solid;border-width:2px;bottom:0;box-sizing:border-box;content:"";height:20px;margin:auto;position:absolute;right:10px;top:0;width:20px}.auto-is-loading .auto-clear[data-v-c1d76900]{display:none}@keyframes auto-spinner-c1d76900{to{transform:rotate(1turn)}}li.loupe[data-v-c1d76900]:before{bottom:auto;top:15px}.loupe input[data-v-c1d76900]{padding:12px 45px 12px 35px}.loupe[data-v-c1d76900]:before{background-image:var(--loupe-icon);bottom:0;content:"";height:17px;left:10px;margin:auto;position:absolute;top:0;width:17px}.auto-selected[data-v-c1d76900]:before{opacity:1}.auto-clear[data-v-c1d76900]{align-items:center;background-color:transparent;border:none;bottom:0;cursor:pointer;display:flex;height:auto;justify-content:center;margin:auto;position:absolute;right:0;top:0;width:40px}.auto-clear[data-v-c1d76900]:before{content:var(--close-button);height:24px;line-height:100%;width:24px}.auto-clear span[data-v-c1d76900]{display:none}.auto-results-wrapper[data-v-c1d76900]{background-color:#fff;border:1px solid #858585;border-top:none;box-sizing:border-box;display:none;overflow:hidden}.auto-results-wrapper ul>.loupe[data-v-c1d76900]{padding-left:40px}.auto-results-wrapper.auto-is-active[data-v-c1d76900]{display:block;margin-top:-1px;position:absolute;width:100%;z-index:99999}.auto-selected[data-v-c1d76900]{background-color:#e6e6e6}.auto-selected+li[data-v-c1d76900]:before{border-top:none}.auto-error[data-v-c1d76900]{border:1px solid #ff3838}.auto-error[data-v-c1d76900]::placeholder{color:#f66;opacity:1}.hidden[data-v-c1d76900]{display:none}
`,te=$(Z,[["styles",[ee]],["__scopeId","data-v-c1d76900"]]),oe=t=>(e.pushScopeId("data-v-72d4acfd"),t=t(),e.popScopeId(),t),ne=["id"],ae={key:0,class:"o_annotate_label"},le={key:1},re={key:2},ie={key:0,class:"contextmenu_item"},se={key:1},ce=["onClickCapture"],ue=["innerHTML"],de={key:0,style:{float:"right"}},pe=oe(()=>e.createElementVNode("i",null,"...loading",-1)),fe=[pe],me={key:0},ge=e.defineComponent({__name:"ontology-annotate.ce",props:{label:{type:String,required:!1,default:""},info:{type:String,required:!1,default:""},placeholder:{type:String,required:!1,default:""},ontologies:{type:String,required:!1,default:""},format:{type:String,required:!1,default:"text"}},emits:["change"],setup(t,{emit:u}){const d=t,r=(Math.random()+1).toString(36).substring(7),o=e.ref(null),f=e.ref(!1);let m=e.ref(""),a=e.ref({x:-1e3,y:0,start:-1,end:-1}),i=e.ref(""),g=e.ref(!1),c=e.ref([]),_=e.reactive([]);const l=new WeakMap,h=e.computed(()=>"left:"+a.value.x+"px; top:"+a.value.y+"px"),n=e.computed(()=>{let s=f?o.value?.value:m.value;return s?d.format&&d.format=="json"?{text:s,ontology:_}:s+`
$$$$
`+_.map(p=>p.ontology.type[0]+"	"+p.ontology.ontology_prefix+" "+p.context.start+" "+p.context.end+"	"+p.ontology.label+"	"+p.ontology.iri).join(`
`):null});e.onMounted(()=>{var s=document.getElementsByTagName("ontology-annotate")[0];s?.shadowRoot&&(f.value=!0)});function w(s){m.value=s.target.innerText,u("change",n.value)}function S(s){let p={ontology:{},context:{}};if(!f)p={ontology:s,context:a.value};else if(o){let y={x:0,y:0,start:o.value?.selectionStart,end:o.value?.selectionEnd};p={ontology:s,context:y}}_.push(p),c.value=[],i.value="",u("change",n.value)}function E(s){if(i.value="",window.getSelection){var p=window.getSelection();i.value=p?.toString(),i.value&&i.value!=""?(c.value=[],B(p),C(s)):(a.value={x:-1e3,y:0,start:-1,end:-1},c.value=[])}}function B(s,p=!0){if(!s?.rangeCount)return null;let y=s.getRangeAt(0).cloneRange();if(!y.getClientRects)return null;y.collapse(p);let b=y.getClientRects();if(b.length<=0)a.value.x=0,a.value.y=0;else{let v=b[0];a.value.start=s.anchorOffset,a.value.end=s.focusOffset,a.value.x=v.x,a.value.y=v.y+b[0]?.height}}async function C(s){if(i.value==="")return c.value=[],[];let p=i.value.indexOf(":"),y="",b=null;p<0?(y=d.ontologies,b=i.value):(b=i.value.split(":")[1],y=i.value.split(":")[0]);const v=s.currentTarget,x=l.get(v);x&&x.abort();const k=new AbortController;l.set(v,k);const V="https://service.tib.eu/ts4tib/api/select?q=",q=encodeURI("&ontolog-y="+y+"&fieldList=iri,label,short_form,obo_id,ontology_name,ontology_prefix,description,type&obsoletes=false&local=false&rows=10");g.value=!0,(await fetch(`${V}${b}${q}`,{signal:k.signal})).json().then(I=>{l.delete(v),c.value=I.response.docs,g.value=!1})}return(s,p)=>(e.openBlock(),e.createElementBlock("div",{id:"o_annotate_wrapper_"+e.unref(r),class:"o_annotate_wrapper"},[t.label?(e.openBlock(),e.createElementBlock("label",ae,e.toDisplayString(t.label),1)):e.createCommentVNode("",!0),f.value?(e.openBlock(),e.createElementBlock("div",re,[e.createElementVNode("textarea",{ref_key:"o_annotate_textarea",ref:o,onMouseup:E,onKeyup:E,onInput:w,class:"o_annotate_textarea"},e.toDisplayString(e.unref(m)),545)])):(e.openBlock(),e.createElementBlock("div",le,[e.createElementVNode("div",{onMouseup:E,onKeyup:E,onInput:w,class:"o_annotate_textarea",ref:"o_annotate_div",contenteditable:"true"},e.toDisplayString(e.unref(m)),545)])),e.unref(i)!=""?(e.openBlock(),e.createElementBlock("div",{key:3,class:"contextmenu",style:e.normalizeStyle(e.unref(h))},[e.unref(c).length==0&&!e.unref(g)?(e.openBlock(),e.createElementBlock("div",ie,"No matches found")):(e.openBlock(),e.createElementBlock("div",se,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(c),y=>(e.openBlock(),e.createElementBlock("div",{class:"contextmenu_item",key:y.short_label,role:"option",tabindex:"_1",aria_selected:"false",aria_setsize:"3",aria_posinset:"0",onClickCapture:e.withModifiers(b=>S(y),["stop","prevent"])},[e.createElementVNode("p",{innerHTML:y.label},null,8,ue),e.createElementVNode("small",null,e.toDisplayString(y.ontology_prefix)+":"+e.toDisplayString(y.short_form),1)],40,ce))),128))]))],4)):e.createCommentVNode("",!0),e.createElementVNode("div",null,[e.unref(g)?(e.openBlock(),e.createElementBlock("div",de,fe)):e.createCommentVNode("",!0),e.createElementVNode("div",null,[t.info?(e.openBlock(),e.createElementBlock("span",me,e.toDisplayString(t.info),1)):e.createCommentVNode("",!0)])])],8,ne))}}),ve=`.o_annotate_textarea[data-v-72d4acfd]{min-height:100px;width:100%;border:1px solid #d7d7d7;box-shadow:none;box-sizing:border_box;padding:12px 10px;resize:none}#mainInput[data-v-72d4acfd]{background:transparent;color:#000;opacity:1}.contextmenu[data-v-72d4acfd]{position:absolute;top:0;right:0;background:#ffffff;color:#000;border:1px solid #f1f1f2;width:15rem;max-width:calc(100vw _ 2rem);max-height:300px;overflow-y:scroll;overflow-x:hidden;z-index:100;box-shadow:0 .5rem 1.5rem #0003;border-radius:.2rem}.contextmenu .contextmenu_item[data-v-72d4acfd]{border-bottom:1px solid #c3c3c3;padding:8px}.contextmenu .contextmenu_item[data-v-72d4acfd]:hover{cursor:pointer;background-color:#f1f1f2}.contextmenu .contextmenu_item p[data-v-72d4acfd]{margin:0;padding:0}.contextmenu .contextmenu_item .iri[data-v-72d4acfd]{margin:0;width:15rem;white-space:nowrap;text-overflow:ellipsis;word-wrap:break_word;padding:0}
`,he=$(ge,[["styles",[ve]],["__scopeId","data-v-72d4acfd"]]),ye={key:0},xe=["onKeyup","onChange"],be={key:1},_e={key:2},ke={key:3},we=e.defineComponent({__name:"ontology-compose.ce",props:{label:{type:String,required:!1,default:""},info:{type:String,required:!1,default:""},placeholder:{type:String,required:!1,default:""},format:{type:String,required:!1,default:"text"}},emits:["change"],setup(t,{emit:u}){const d=t;let r=e.ref(""),o=e.ref(""),f=-1,m=100,a=0,i=e.ref([]),g="",c="",_=!1,l=e.ref([]),h=e.ref([]),n=e.ref(null);const w=e.computed(()=>n.value?n.value?n.value.label+"	"+n.value.ontology_prefix+"	"+n.value.iri+"	"+n.value.type:"":null),S=e.computed(()=>r.value?d.format&&d.format=="json"?{text:r.value,ontology:l.value}:r.value+`
$$$$
`+l.value.join(`
`):null);async function E(v){if(r.value==""){o.value="";return}if(f>-1&&clearTimeout(f),v.key=="ArrowDown"){a==9&&C(),a+=1,b(),v.preventDefault();return}else if(v.key=="ArrowUp"){a==0&&C(),a-=1,b(),v.preventDefault();return}else if(v.key=="ArrowRight")v.preventDefault(),p();else if(r.value){let x=r.value.split(" ");x.length>1?(g=x.slice(-1)[0],c=x.slice(-2).join(" ")):(g=x[0],c=g),g==""&&(_=!1,n.value=null,o.value=r.value),_&&(g=c),s()}}function B(){u("change",S.value)}function C(){_=!0,g=c,a=0,s()}function s(){f=setTimeout(function(){y()},m)}function p(){r.value=o.value,l.value.push(w.value),h.value.push(n.value)}async function y(){const v="https://service.tib.eu/ts4tib/api/select?q=",x=encodeURI("&obsoletes=false&local=false&rows=10");(await fetch(`${v}${g}${x}`)).json().then(V=>{i.value=V.response.docs,i.value.length>0&&(a=0,b())})}function b(){let v="";n.value=i.value[a],v=n.value.label;let x=v.toLowerCase().replace(g,"");x!=null&&(o.value=r.value+x)}return(v,x)=>(e.openBlock(),e.createElementBlock("div",null,[t.label?(e.openBlock(),e.createElementBlock("label",ye,e.toDisplayString(t.label),1)):e.createCommentVNode("",!0),e.createElementVNode("div",null,[e.withDirectives(e.createElementVNode("textarea",{"onUpdate:modelValue":x[0]||(x[0]=k=>e.isRef(o)?o.value=k:o=k),id:"autocomplete",type:"text",class:"o_annotate_textarea",line:"10"},null,512),[[e.vModelText,e.unref(o)]]),e.withDirectives(e.createElementVNode("textarea",{id:"mainInput",onKeyup:e.withModifiers(E,["stop"]),onChange:e.withModifiers(B,["stop"]),"onUpdate:modelValue":x[1]||(x[1]=k=>e.isRef(r)?r.value=k:r=k),type:"text",class:"o_annotate_textarea"},null,40,xe),[[e.vModelText,e.unref(r)]])]),t.info&&e.unref(i).length==0?(e.openBlock(),e.createElementBlock("p",be,e.toDisplayString(t.info),1)):e.createCommentVNode("",!0),e.unref(n)?(e.openBlock(),e.createElementBlock("span",_e,[e.createElementVNode("code",null,[e.createElementVNode("pre",null,e.toDisplayString(e.unref(w)),1)])])):e.createCommentVNode("",!0),e.unref(l)&&e.unref(l).length>0?(e.openBlock(),e.createElementBlock("span",ke,[e.createElementVNode("code",null,[e.createElementVNode("pre",null,e.toDisplayString(e.unref(S)),1)])])):e.createCommentVNode("",!0)]))}}),Ee=`.o_annotate_textarea[data-v-030af0eb]{min-height:100px;width:100%;border:1px solid #d7d7d7;box-shadow:none;box-sizing:border-box;padding:12px 10px;resize:none}#mainInput[data-v-030af0eb]{background:transparent;color:#000;opacity:100}#autocomplete[data-v-030af0eb]{position:absolute;box-sizing:border-box;cursor:text;pointer-events:none;color:#000;opacity:.6;background:transparent}
`,Se=$(we,[["styles",[Ee]],["__scopeId","data-v-030af0eb"]]),T=e.defineCustomElement(z),N=e.defineCustomElement(H),O=e.defineCustomElement(te),M=e.defineCustomElement(he),D=e.defineCustomElement(Se);if(typeof window<"u"){let t=window.customElements;t.define("ontology-term-annotation",T),t.define("ontology-text-annotation",N),t.define("ontology-autocomplete",O),t.define("ontology-annotate",M),t.define("ontology-compose",D)}exports.OntologyAnnotate=M;exports.OntologyAutoComplete=O;exports.OntologyCompose=D;exports.OntologyTermAnnotation=T;exports.OntologyTextAnnotation=N;
//# sourceMappingURL=index.cjs.map
