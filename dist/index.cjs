"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const e=require("vue"),A=["href"],L=e.defineComponent({__name:"ontology-term-annotation.ce",props:{annotation:null},setup(t){const s=t,m=e.computed(()=>s.annotation?s.annotation.split("	")[0]:""),o=e.computed(()=>s.annotation?s.annotation.split("	")[2]:""),n=e.computed(()=>s.annotation?s.annotation.split("	")[1]:"");return(x,_)=>t.annotation&&t.annotation!=""?(e.openBlock(),e.createElementBlock("a",{key:0,href:e.unref(o),target:"_blank"},e.toDisplayString(e.unref(n))+": "+e.toDisplayString(e.unref(m)),9,A)):e.createCommentVNode("",!0)}}),z=["innerHTML"],R=e.defineComponent({__name:"ontology-text-annotation.ce",props:{annotation:null},setup(t){const s=t,m=e.computed(()=>s.annotation?s.annotation.split("$$$$")[0]:""),o=e.computed(()=>{let n=`${m.value}`,x=s.annotation?s.annotation.split("$$$$")[1].split(/\r?\n/).filter(l=>l):[],_=[];return x.forEach(l=>{let a=l.split("	"),u=a[1].split(" "),i={};i.value=n.substring(parseInt(u[1]),parseInt(u[2])),i.class=a[0],i.ontology=u[0],i.ontology_term=a[2],i.iri=a[3],_.push(i)}),_.forEach(l=>{n=n.replace(l.value,'<span class="o_term"><a target="_blank" href='+l.iri+">"+l.value+"</a></span>")}),n});return(n,x)=>(e.openBlock(),e.createElementBlock("div",{innerHTML:e.unref(o)},null,8,z))}}),j=`.o_term[data-v-6b855a10]{background-color:#cdcdcd;border-radius:4px;padding:1px 3px}
`,C=(t,s)=>{const m=t.__vccOpts||t;for(const[o,n]of s)m[o]=n;return m},H=C(R,[["styles",[j]],["__scopeId","data-v-6b855a10"]]),U={class:"auto-search-wrapper"},K={key:0},P=["onInput","placeholder"],W={key:1},F={key:2,class:"auto-results-wrapper auto-is-active"},J={tabindex:"0",role:"listbox"},G=["onClick"],Q=["innerHTML"],X=["innerHTML"],Y={key:3,type:"button","aria-label":"clear the search query"},Z=e.defineComponent({__name:"ontology-autocomplete.ce",props:{label:{type:String,required:!1,default:""},info:{type:String,required:!1,default:""},placeholder:{type:String,required:!1,default:""},ontologies:{type:String,required:!1,default:""},format:{type:String,required:!1,default:"text"}},emits:["change"],setup(t,{emit:s}){const m=t;let o=e.ref(""),n=e.ref([]);async function x(){if(o.value==="")return n.value=[],[];let d=o.value.indexOf(":"),f="",g=null;d<0?(f=m.ontologies,g=o.value):(g=o.value.split(":")[1],f=o.value.split(":")[0]);const v="https://service.tib.eu/ts4tib/api/select?q=",E=encodeURI("&ontology="+f+"&fieldList=iri,label,short_form,obo_id,ontology_name,ontology_prefix,description,type&obsoletes=false&local=false&rows=10");(await fetch(`${v}${g}${E}`)).json().then(w=>{n.value=w.response.docs})}function _(d){return o.value?d.replace(new RegExp(o.value,"gi"),f=>'<span class="highlightText">'+f+"</span>"):d}function l(d){return d?d.join(""):""}let a=e.ref(null);const u=e.computed(()=>a.value?m.format&&m.format=="json"?a.value:a.value?a.value.label+"	"+a.value.ontology_prefix+"	"+a.value.iri+"	"+a.value.type:"":null),i=d=>{a.value=d,o.value=d.label,s("change",u.value),n.value=[]};return(d,f)=>(e.openBlock(),e.createElementBlock("div",U,[t.label?(e.openBlock(),e.createElementBlock("label",K,e.toDisplayString(t.label),1)):e.createCommentVNode("",!0),e.withDirectives(e.createElementVNode("input",{type:"text",id:"search","onUpdate:modelValue":f[0]||(f[0]=g=>e.isRef(o)?o.value=g:o=g),onInput:e.withModifiers(x,["stop"]),placeholder:t.placeholder,autocomplete:"off"},null,40,P),[[e.vModelText,e.unref(o)]]),t.info&&e.unref(n).length==0?(e.openBlock(),e.createElementBlock("p",W,e.toDisplayString(t.info),1)):(e.openBlock(),e.createElementBlock("div",F,[e.createElementVNode("ul",J,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(n),g=>(e.openBlock(),e.createElementBlock("li",{key:g.short_label,role:"option",tabindex:"-1","aria-selected":"false","aria-setsize":"3","aria-posinset":"0",onClick:v=>i(g)},[e.createElementVNode("p",{innerHTML:_(g.label)},null,8,Q),e.createElementVNode("p",null,[e.createElementVNode("small",{innerHTML:l(g.description)},null,8,X)]),e.createElementVNode("small",null,e.toDisplayString(g.ontology_prefix)+":"+e.toDisplayString(g.iri),1)],8,G))),128))])])),e.unref(o)!=""&&e.unref(n).length>0?(e.openBlock(),e.createElementBlock("button",Y)):e.createCommentVNode("",!0)]))}}),ee=`[data-v-d4fc57ea]:root{--close-button: url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath d='M18.984 6.422 13.406 12l5.578 5.578-1.406 1.406L12 13.406l-5.578 5.578-1.406-1.406L10.594 12 5.016 6.422l1.406-1.406L12 10.594l5.578-5.578z'/%3E%3C/svg%3E");--loupe-icon: url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath fill='%23929292' d='M16.041 15.856a.995.995 0 0 0-.186.186A6.97 6.97 0 0 1 11 18c-1.933 0-3.682-.782-4.95-2.05S4 12.933 4 11s.782-3.682 2.05-4.95S9.067 4 11 4s3.682.782 4.95 2.05S18 9.067 18 11a6.971 6.971 0 0 1-1.959 4.856zm5.666 4.437-3.675-3.675A8.967 8.967 0 0 0 20 11c0-2.485-1.008-4.736-2.636-6.364S13.485 2 11 2 6.264 3.008 4.636 4.636 2 8.515 2 11s1.008 4.736 2.636 6.364S8.515 20 11 20a8.967 8.967 0 0 0 5.618-1.968l3.675 3.675a.999.999 0 1 0 1.414-1.414z'/%3E%3C/svg%3E")}.auto-search-wrapper[data-v-d4fc57ea]{display:block;position:relative;width:100%}.auto-search-wrapper p[data-v-d4fc57ea]{margin:0;padding:0;font-size:1.1em}.auto-search-wrapper p .highlightText[data-v-d4fc57ea]{font-weight:700}.auto-search-wrapper input[data-v-d4fc57ea]{border:1px solid #d7d7d7;box-shadow:none;box-sizing:border-box;font-size:16px;padding:12px 45px 12px 10px;width:100%}.auto-search-wrapper input[data-v-d4fc57ea]:focus{border:1px solid #858585;outline:none}.auto-search-wrapper input[data-v-d4fc57ea]::-ms-clear{display:none}.auto-search-wrapper ul[data-v-d4fc57ea]{list-style:none;margin:0;overflow:auto;padding:0}.auto-search-wrapper ul li[data-v-d4fc57ea]{cursor:pointer;margin:0;overflow:hidden;padding:10px;position:relative;border:1px dotted #f1f1f2}.auto-search-wrapper ul li[data-v-d4fc57ea]:hover{background-color:#f1f1f2}.auto-search-wrapper ul li[data-v-d4fc57ea]:not(:last-child){border-top:none}.auto-search-wrapper ul li[disabled][data-v-d4fc57ea]{background:#ececec;opacity:.5;pointer-events:none}.auto-search-wrapper .auto-expanded[data-v-d4fc57ea]{border:1px solid #858585;outline:none}.auto-search-wrapper.loupe[data-v-d4fc57ea]:before{filter:invert(60%)}.auto-is-loading[data-v-d4fc57ea]:after{animation:auto-spinner-d4fc57ea .6s linear infinite;border-color:#d9d9d9 grey grey #d9d9d9;border-radius:50%;border-style:solid;border-width:2px;bottom:0;box-sizing:border-box;content:"";height:20px;margin:auto;position:absolute;right:10px;top:0;width:20px}.auto-is-loading .auto-clear[data-v-d4fc57ea]{display:none}@keyframes auto-spinner-d4fc57ea{to{transform:rotate(1turn)}}li.loupe[data-v-d4fc57ea]:before{bottom:auto;top:15px}.loupe input[data-v-d4fc57ea]{padding:12px 45px 12px 35px}.loupe[data-v-d4fc57ea]:before{background-image:var(--loupe-icon);bottom:0;content:"";height:17px;left:10px;margin:auto;position:absolute;top:0;width:17px}.auto-selected[data-v-d4fc57ea]:before{opacity:1}.auto-clear[data-v-d4fc57ea]{align-items:center;background-color:transparent;border:none;bottom:0;cursor:pointer;display:flex;height:auto;justify-content:center;margin:auto;position:absolute;right:0;top:0;width:40px}.auto-clear[data-v-d4fc57ea]:before{content:var(--close-button);height:24px;line-height:100%;width:24px}.auto-clear span[data-v-d4fc57ea]{display:none}.auto-results-wrapper[data-v-d4fc57ea]{background-color:#fff;border:1px solid #858585;border-top:none;box-sizing:border-box;display:none;overflow:hidden}.auto-results-wrapper ul>.loupe[data-v-d4fc57ea]{padding-left:40px}.auto-results-wrapper.auto-is-active[data-v-d4fc57ea]{display:block;margin-top:-1px;position:absolute;width:100%;z-index:99999}.auto-selected[data-v-d4fc57ea]{background-color:#e6e6e6}.auto-selected+li[data-v-d4fc57ea]:before{border-top:none}.auto-error[data-v-d4fc57ea]{border:1px solid #ff3838}.auto-error[data-v-d4fc57ea]::placeholder{color:#f66;opacity:1}.hidden[data-v-d4fc57ea]{display:none}
`,te=C(Z,[["styles",[ee]],["__scopeId","data-v-d4fc57ea"]]),oe=t=>(e.pushScopeId("data-v-aaa7ce3e"),t=t(),e.popScopeId(),t),ne=["id"],ae={key:0,class:"o_annotate_label"},le={key:1},re={key:2},ie={key:0,class:"contextmenu_item"},se={key:1},ce=["onClickCapture"],ue=["innerHTML"],de={key:0,style:{float:"right"}},pe=oe(()=>e.createElementVNode("i",null,"...loading",-1)),fe=[pe],me={key:0},ge=e.defineComponent({__name:"ontology-annotate.ce",props:{label:{type:String,required:!1,default:""},info:{type:String,required:!1,default:""},placeholder:{type:String,required:!1,default:""},ontologies:{type:String,required:!1,default:""},format:{type:String,required:!1,default:"text"}},emits:["change"],setup(t,{emit:s}){const m=t,o=(Math.random()+1).toString(36).substring(7),n=e.ref(null),x=e.ref(!1);let _=e.ref(""),l=e.ref({x:-1e3,y:0,start:-1,end:-1}),a=e.ref(""),u=e.ref(!1),i=e.ref([]),d=e.reactive([]);const f=new WeakMap,g=e.computed(()=>"left:"+l.value.x+"px; top:"+l.value.y+"px"),v=e.computed(()=>{let r=x?n.value?.value:_.value;return r?m.format&&m.format=="json"?{text:r,ontology:d}:r+`
$$$$
`+d.map(c=>c.ontology.type[0]+"	"+c.ontology.ontology_prefix+" "+c.context.start+" "+c.context.end+"	"+c.ontology.label+"	"+c.ontology.iri).join(`
`):null});e.onMounted(()=>{var r=document.getElementsByTagName("ontology-annotate")[0];r?.shadowRoot&&(x.value=!0)});function E(r){_.value=r.target.innerText,s("change",v.value)}function B(r){let c={ontology:{},context:{}};if(!x)c={ontology:r,context:l.value};else if(n){let h={x:0,y:0,start:n.value?.selectionStart,end:n.value?.selectionEnd};c={ontology:r,context:h}}d.push(c),i.value=[],a.value="",s("change",v.value)}function w(r){if(a.value="",window.getSelection){var c=window.getSelection();a.value=c?.toString(),a.value&&a.value!=""?(i.value=[],$(c),S(r)):(l.value={x:-1e3,y:0,start:-1,end:-1},i.value=[])}}function $(r,c=!0){if(!r?.rangeCount)return null;let h=r.getRangeAt(0).cloneRange();if(!h.getClientRects)return null;h.collapse(c);let b=h.getClientRects();if(b.length<=0)l.value.x=0,l.value.y=0;else{let p=b[0];l.value.start=r.anchorOffset,l.value.end=r.focusOffset,l.value.x=p.x,l.value.y=p.y+b[0]?.height}}async function S(r){if(a.value==="")return i.value=[],[];let c=a.value.indexOf(":"),h="",b=null;c<0?(h=m.ontologies,b=a.value):(b=a.value.split(":")[1],h=a.value.split(":")[0]);const p=r.currentTarget,y=f.get(p);y&&y.abort();const k=new AbortController;f.set(p,k);const T="https://service.tib.eu/ts4tib/api/select?q=",q=encodeURI("&ontolog-y="+h+"&fieldList=iri,label,short_form,obo_id,ontology_name,ontology_prefix,description,type&obsoletes=false&local=false&rows=10");u.value=!0,(await fetch(`${T}${b}${q}`,{signal:k.signal})).json().then(I=>{f.delete(p),i.value=I.response.docs,u.value=!1})}return(r,c)=>(e.openBlock(),e.createElementBlock("div",{id:"o_annotate_wrapper_"+e.unref(o),class:"o_annotate_wrapper"},[t.label?(e.openBlock(),e.createElementBlock("label",ae,e.toDisplayString(t.label),1)):e.createCommentVNode("",!0),x.value?(e.openBlock(),e.createElementBlock("div",re,[e.createElementVNode("textarea",{ref_key:"o_annotate_textarea",ref:n,onMouseup:w,onKeyup:w,onInput:E,class:"o_annotate_textarea"},e.toDisplayString(e.unref(_)),545)])):(e.openBlock(),e.createElementBlock("div",le,[e.createElementVNode("div",{onMouseup:w,onKeyup:w,onInput:E,class:"o_annotate_textarea",ref:"o_annotate_div",contenteditable:"true"},e.toDisplayString(e.unref(_)),545)])),e.unref(a)!=""?(e.openBlock(),e.createElementBlock("div",{key:3,class:"contextmenu",style:e.normalizeStyle(e.unref(g))},[e.unref(i).length==0&&!e.unref(u)?(e.openBlock(),e.createElementBlock("div",ie,"No matches found")):(e.openBlock(),e.createElementBlock("div",se,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(i),h=>(e.openBlock(),e.createElementBlock("div",{class:"contextmenu_item",key:h.short_label,role:"option",tabindex:"_1",aria_selected:"false",aria_setsize:"3",aria_posinset:"0",onClickCapture:e.withModifiers(b=>B(h),["stop","prevent"])},[e.createElementVNode("p",{innerHTML:h.label},null,8,ue),e.createElementVNode("small",null,e.toDisplayString(h.ontology_prefix)+":"+e.toDisplayString(h.short_form),1)],40,ce))),128))]))],4)):e.createCommentVNode("",!0),e.createElementVNode("div",null,[e.unref(u)?(e.openBlock(),e.createElementBlock("div",de,fe)):e.createCommentVNode("",!0),e.createElementVNode("div",null,[t.info?(e.openBlock(),e.createElementBlock("span",me,e.toDisplayString(t.info),1)):e.createCommentVNode("",!0)])])],8,ne))}}),ve=`.o_annotate_textarea[data-v-aaa7ce3e]{min-height:100px;width:100%;border:1px solid #d7d7d7;box-shadow:none;box-sizing:border_box;padding:12px 10px;resize:none}#mainInput[data-v-aaa7ce3e]{background:transparent;color:#000;opacity:1}.contextmenu[data-v-aaa7ce3e]{position:absolute;top:0;right:0;background:#ffffff;color:#000;border:1px solid #f1f1f2;width:15rem;max-width:calc(100vw _ 2rem);max-height:300px;overflow-y:scroll;overflow-x:hidden;z-index:100;box-shadow:0 .5rem 1.5rem #0003;border-radius:.2rem}.contextmenu .contextmenu_item[data-v-aaa7ce3e]{border-bottom:1px solid #c3c3c3;padding:8px}.contextmenu .contextmenu_item[data-v-aaa7ce3e]:hover{cursor:pointer;background-color:#f1f1f2}.contextmenu .contextmenu_item p[data-v-aaa7ce3e]{margin:0;padding:0}.contextmenu .contextmenu_item .iri[data-v-aaa7ce3e]{margin:0;width:15rem;white-space:nowrap;text-overflow:ellipsis;word-wrap:break_word;padding:0}
`,he=C(ge,[["styles",[ve]],["__scopeId","data-v-aaa7ce3e"]]),ye={key:0},xe=["onKeyup","onChange"],_e={key:1},be={key:2},ke={key:3},we=e.defineComponent({__name:"ontology-compose.ce",props:{label:{type:String,required:!1,default:""},info:{type:String,required:!1,default:""},placeholder:{type:String,required:!1,default:""},format:{type:String,required:!1,default:"text"}},emits:["change"],setup(t,{emit:s}){const m=t;let o=e.ref(""),n=e.ref(""),x=-1,_=100,l=0,a=e.ref([]),u="",i="",d=!1,f=e.ref([]),g=e.ref([]),v=e.ref(null);const E=e.computed(()=>v.value?v.value?v.value.label+"	"+v.value.ontology_prefix+"	"+v.value.iri+"	"+v.value.type:"":null),B=e.computed(()=>o.value?m.format&&m.format=="json"?{text:o.value,ontology:f.value}:o.value+`
$$$$
`+f.value.join(`
`):null);async function w(p){if(o.value==""){n.value="";return}if(x>-1&&clearTimeout(x),p.key=="ArrowDown"){l==9&&S(),l+=1,b(),p.preventDefault();return}else if(p.key=="ArrowUp"){l==0&&S(),l-=1,b(),p.preventDefault();return}else if(p.key=="ArrowRight")p.preventDefault(),c();else if(o.value){let y=o.value.split(" ");y.length>1?(u=y.slice(-1)[0],i=y.slice(-2).join(" ")):(u=y[0],i=u),u==""&&(d=!1,v.value=null,n.value=o.value),d&&(u=i),r()}}function $(){s("change",B.value)}function S(){d=!0,u=i,l=0,r()}function r(){x=setTimeout(function(){h()},_)}function c(){o.value=n.value,f.value.push(E.value),g.value.push(v.value)}async function h(){const p="https://service.tib.eu/ts4tib/api/select?q=",y=encodeURI("&obsoletes=false&local=false&rows=10");(await fetch(`${p}${u}${y}`)).json().then(T=>{a.value=T.response.docs,a.value.length>0&&(l=0,b())})}function b(){let p="";v.value=a.value[l],p=v.value.label;let y=p.toLowerCase().replace(u,"");y!=null&&(n.value=o.value+y)}return(p,y)=>(e.openBlock(),e.createElementBlock("div",null,[t.label?(e.openBlock(),e.createElementBlock("label",ye,e.toDisplayString(t.label),1)):e.createCommentVNode("",!0),e.createElementVNode("div",null,[e.withDirectives(e.createElementVNode("textarea",{"onUpdate:modelValue":y[0]||(y[0]=k=>e.isRef(n)?n.value=k:n=k),id:"autocomplete",type:"text",class:"o_annotate_textarea",line:"10"},null,512),[[e.vModelText,e.unref(n)]]),e.withDirectives(e.createElementVNode("textarea",{id:"mainInput",onKeyup:e.withModifiers(w,["stop"]),onChange:e.withModifiers($,["stop"]),"onUpdate:modelValue":y[1]||(y[1]=k=>e.isRef(o)?o.value=k:o=k),type:"text",class:"o_annotate_textarea"},null,40,xe),[[e.vModelText,e.unref(o)]])]),t.info&&e.unref(a).length==0?(e.openBlock(),e.createElementBlock("p",_e,e.toDisplayString(t.info),1)):e.createCommentVNode("",!0),e.unref(v)?(e.openBlock(),e.createElementBlock("span",be,[e.createElementVNode("code",null,[e.createElementVNode("pre",null,e.toDisplayString(e.unref(E)),1)])])):e.createCommentVNode("",!0),e.unref(f)&&e.unref(f).length>0?(e.openBlock(),e.createElementBlock("span",ke,[e.createElementVNode("code",null,[e.createElementVNode("pre",null,e.toDisplayString(e.unref(B)),1)])])):e.createCommentVNode("",!0)]))}}),Ee=`.o_annotate_textarea[data-v-f73143e2]{min-height:100px;width:100%;border:1px solid #d7d7d7;box-shadow:none;box-sizing:border-box;padding:12px 10px;resize:none}#mainInput[data-v-f73143e2]{background:transparent;color:#000;opacity:100}#autocomplete[data-v-f73143e2]{position:absolute;box-sizing:border-box;cursor:text;pointer-events:none;color:#000;opacity:.6;background:transparent}
`,Be=C(we,[["styles",[Ee]],["__scopeId","data-v-f73143e2"]]),V=e.defineCustomElement(L),N=e.defineCustomElement(H),M=e.defineCustomElement(te),D=e.defineCustomElement(he),O=e.defineCustomElement(Be);if(typeof window<"u"){let t=window.customElements;t.define("ontology-term-annotation",V),t.define("ontology-text-annotation",N),t.define("ontology-autocomplete",M),t.define("ontology-annotate",D),t.define("ontology-compose",O)}exports.OntologyAnnotate=D;exports.OntologyAutoComplete=M;exports.OntologyCompose=O;exports.OntologyTermAnnotation=V;exports.OntologyTextAnnotation=N;
//# sourceMappingURL=index.cjs.map
