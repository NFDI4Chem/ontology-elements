"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const e=require("vue"),I=["href"],A=e.defineComponent({__name:"ontology-annotation.ce",props:{annotation:null},setup(t){const g=t,v=e.computed(()=>g.annotation?g.annotation.split("	")[0]:""),o=e.computed(()=>g.annotation?g.annotation.split("	")[2]:""),n=e.computed(()=>g.annotation?g.annotation.split("	")[1]:"");return(b,_)=>t.annotation&&t.annotation!=""?(e.openBlock(),e.createElementBlock("a",{key:0,href:e.unref(o),target:"_blank"},e.toDisplayString(e.unref(n))+": "+e.toDisplayString(e.unref(v)),9,I)):e.createCommentVNode("",!0)}}),z={class:"auto-search-wrapper"},L={key:0},R=["onInput","placeholder"],j={key:1},U={key:2,class:"auto-results-wrapper auto-is-active"},H={tabindex:"0",role:"listbox"},K=["onClick"],P=["innerHTML"],W=["innerHTML"],F={key:3,type:"button","aria-label":"clear the search query"},J=e.defineComponent({__name:"ontology-autocomplete.ce",props:{label:{type:String,required:!1,default:""},info:{type:String,required:!1,default:""},placeholder:{type:String,required:!1,default:""},ontologies:{type:String,required:!1,default:""},format:{type:String,required:!1,default:"text"}},emits:["change"],setup(t,{emit:g}){const v=t;let o=e.ref(""),n=e.ref([]);async function b(){if(o.value==="")return n.value=[],[];let s=o.value.indexOf(":"),u="",d=null;s<0?(u=v.ontologies,d=o.value):(d=o.value.split(":")[1],u=o.value.split(":")[0]);const p="https://service.tib.eu/ts4tib/api/select?q=",E=encodeURI("&ontology="+u+"&fieldList=iri,label,short_form,obo_id,ontology_name,ontology_prefix,description,type&obsoletes=false&local=false&rows=10");(await fetch(`${p}${d}${E}`)).json().then(w=>{n.value=w.response.docs})}function _(s){return o.value?s.replace(new RegExp(o.value,"gi"),u=>'<span class="highlightText">'+u+"</span>"):s}function r(s){return s?s.join(""):""}let a=e.ref(null);const h=e.computed(()=>a.value?v.format&&v.format=="json"?a.value:a.value?a.value.label+"	"+a.value.ontology_prefix+"	"+a.value.iri+"	"+a.value.type:"":null),y=s=>{a.value=s,o.value=s.label,g("change",h.value),n.value=[]};return(s,u)=>(e.openBlock(),e.createElementBlock("div",z,[t.label?(e.openBlock(),e.createElementBlock("label",L,e.toDisplayString(t.label),1)):e.createCommentVNode("",!0),e.withDirectives(e.createElementVNode("input",{type:"text",id:"search","onUpdate:modelValue":u[0]||(u[0]=d=>e.isRef(o)?o.value=d:o=d),onInput:e.withModifiers(b,["stop"]),placeholder:t.placeholder,autocomplete:"off"},null,40,R),[[e.vModelText,e.unref(o)]]),t.info&&e.unref(n).length==0?(e.openBlock(),e.createElementBlock("p",j,e.toDisplayString(t.info),1)):(e.openBlock(),e.createElementBlock("div",U,[e.createElementVNode("ul",H,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(n),d=>(e.openBlock(),e.createElementBlock("li",{key:d.short_label,role:"option",tabindex:"-1","aria-selected":"false","aria-setsize":"3","aria-posinset":"0",onClick:p=>y(d)},[e.createElementVNode("p",{innerHTML:_(d.label)},null,8,P),e.createElementVNode("p",null,[e.createElementVNode("small",{innerHTML:r(d.description)},null,8,W)]),e.createElementVNode("small",null,e.toDisplayString(d.ontology_prefix)+":"+e.toDisplayString(d.iri),1)],8,K))),128))])])),e.unref(o)!=""&&e.unref(n).length>0?(e.openBlock(),e.createElementBlock("button",F)):e.createCommentVNode("",!0)]))}}),G=`[data-v-d4fc57ea]:root{--close-button: url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath d='M18.984 6.422 13.406 12l5.578 5.578-1.406 1.406L12 13.406l-5.578 5.578-1.406-1.406L10.594 12 5.016 6.422l1.406-1.406L12 10.594l5.578-5.578z'/%3E%3C/svg%3E");--loupe-icon: url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath fill='%23929292' d='M16.041 15.856a.995.995 0 0 0-.186.186A6.97 6.97 0 0 1 11 18c-1.933 0-3.682-.782-4.95-2.05S4 12.933 4 11s.782-3.682 2.05-4.95S9.067 4 11 4s3.682.782 4.95 2.05S18 9.067 18 11a6.971 6.971 0 0 1-1.959 4.856zm5.666 4.437-3.675-3.675A8.967 8.967 0 0 0 20 11c0-2.485-1.008-4.736-2.636-6.364S13.485 2 11 2 6.264 3.008 4.636 4.636 2 8.515 2 11s1.008 4.736 2.636 6.364S8.515 20 11 20a8.967 8.967 0 0 0 5.618-1.968l3.675 3.675a.999.999 0 1 0 1.414-1.414z'/%3E%3C/svg%3E")}.auto-search-wrapper[data-v-d4fc57ea]{display:block;position:relative;width:100%}.auto-search-wrapper p[data-v-d4fc57ea]{margin:0;padding:0;font-size:1.1em}.auto-search-wrapper p .highlightText[data-v-d4fc57ea]{font-weight:700}.auto-search-wrapper input[data-v-d4fc57ea]{border:1px solid #d7d7d7;box-shadow:none;box-sizing:border-box;font-size:16px;padding:12px 45px 12px 10px;width:100%}.auto-search-wrapper input[data-v-d4fc57ea]:focus{border:1px solid #858585;outline:none}.auto-search-wrapper input[data-v-d4fc57ea]::-ms-clear{display:none}.auto-search-wrapper ul[data-v-d4fc57ea]{list-style:none;margin:0;overflow:auto;padding:0}.auto-search-wrapper ul li[data-v-d4fc57ea]{cursor:pointer;margin:0;overflow:hidden;padding:10px;position:relative;border:1px dotted #f1f1f2}.auto-search-wrapper ul li[data-v-d4fc57ea]:hover{background-color:#f1f1f2}.auto-search-wrapper ul li[data-v-d4fc57ea]:not(:last-child){border-top:none}.auto-search-wrapper ul li[disabled][data-v-d4fc57ea]{background:#ececec;opacity:.5;pointer-events:none}.auto-search-wrapper .auto-expanded[data-v-d4fc57ea]{border:1px solid #858585;outline:none}.auto-search-wrapper.loupe[data-v-d4fc57ea]:before{filter:invert(60%)}.auto-is-loading[data-v-d4fc57ea]:after{animation:auto-spinner-d4fc57ea .6s linear infinite;border-color:#d9d9d9 grey grey #d9d9d9;border-radius:50%;border-style:solid;border-width:2px;bottom:0;box-sizing:border-box;content:"";height:20px;margin:auto;position:absolute;right:10px;top:0;width:20px}.auto-is-loading .auto-clear[data-v-d4fc57ea]{display:none}@keyframes auto-spinner-d4fc57ea{to{transform:rotate(1turn)}}li.loupe[data-v-d4fc57ea]:before{bottom:auto;top:15px}.loupe input[data-v-d4fc57ea]{padding:12px 45px 12px 35px}.loupe[data-v-d4fc57ea]:before{background-image:var(--loupe-icon);bottom:0;content:"";height:17px;left:10px;margin:auto;position:absolute;top:0;width:17px}.auto-selected[data-v-d4fc57ea]:before{opacity:1}.auto-clear[data-v-d4fc57ea]{align-items:center;background-color:transparent;border:none;bottom:0;cursor:pointer;display:flex;height:auto;justify-content:center;margin:auto;position:absolute;right:0;top:0;width:40px}.auto-clear[data-v-d4fc57ea]:before{content:var(--close-button);height:24px;line-height:100%;width:24px}.auto-clear span[data-v-d4fc57ea]{display:none}.auto-results-wrapper[data-v-d4fc57ea]{background-color:#fff;border:1px solid #858585;border-top:none;box-sizing:border-box;display:none;overflow:hidden}.auto-results-wrapper ul>.loupe[data-v-d4fc57ea]{padding-left:40px}.auto-results-wrapper.auto-is-active[data-v-d4fc57ea]{display:block;margin-top:-1px;position:absolute;width:100%;z-index:99999}.auto-selected[data-v-d4fc57ea]{background-color:#e6e6e6}.auto-selected+li[data-v-d4fc57ea]:before{border-top:none}.auto-error[data-v-d4fc57ea]{border:1px solid #ff3838}.auto-error[data-v-d4fc57ea]::placeholder{color:#f66;opacity:1}.hidden[data-v-d4fc57ea]{display:none}
`,$=(t,g)=>{const v=t.__vccOpts||t;for(const[o,n]of g)v[o]=n;return v},Q=$(J,[["styles",[G]],["__scopeId","data-v-d4fc57ea"]]),X=t=>(e.pushScopeId("data-v-bc5db457"),t=t(),e.popScopeId(),t),Y=["id"],Z={key:0,class:"o_annotate_label"},ee={key:1},te={key:2},oe={key:0,class:"contextmenu_item"},ne={key:1},ae=["onClickCapture"],le=["innerHTML"],re={key:0,style:{float:"right"}},ie=X(()=>e.createElementVNode("i",null,"...loading",-1)),se=[ie],ce={key:0},ue=e.defineComponent({__name:"ontology-annotate.ce",props:{label:{type:String,required:!1,default:""},info:{type:String,required:!1,default:""},placeholder:{type:String,required:!1,default:""},ontologies:{type:String,required:!1,default:""},format:{type:String,required:!1,default:"text"}},emits:["change"],setup(t,{emit:g}){const v=t,o=(Math.random()+1).toString(36).substring(7),n=e.ref(null),b=e.ref(!1);let _=e.ref(""),r=e.ref({x:-1e3,y:0,start:-1,end:-1}),a=e.ref(""),h=e.ref(!1),y=e.ref([]),s=e.reactive([]);const u=new WeakMap,d=e.computed(()=>"left:"+r.value.x+"px; top:"+r.value.y+"px"),p=e.computed(()=>{let l=b?n.value?.value:_.value;return l?v.format&&v.format=="json"?{text:l,ontology:s}:l+`
$$$$
`+s.map(i=>i.ontology.type[0]+"	"+i.ontology.ontology_prefix+" "+i.context.start+" "+i.context.end+"	"+i.ontology.label+"	"+i.ontology.iri).join(`
`):null});e.onMounted(()=>{var l=document.getElementsByTagName("ontology-annotate")[0];l?.shadowRoot&&(b.value=!0)});function E(l){_.value=l.target.innerText,g("change",p.value)}function S(l){let i={ontology:{},context:{}};if(!b)i={ontology:l,context:r.value};else if(n){let f={x:0,y:0,start:n.value?.selectionStart,end:n.value?.selectionEnd};i={ontology:l,context:f}}s.push(i),y.value=[],a.value="",g("change",p.value)}function w(l){if(a.value="",window.getSelection){var i=window.getSelection();a.value=i?.toString(),a.value&&a.value!=""?(y.value=[],C(i),B(l)):(r.value={x:-1e3,y:0,start:-1,end:-1},y.value=[])}}function C(l,i=!0){if(!l?.rangeCount)return null;let f=l.getRangeAt(0).cloneRange();if(!f.getClientRects)return null;f.collapse(i);let x=f.getClientRects();if(x.length<=0)r.value.x=0,r.value.y=0;else{let c=x[0];r.value.start=l.anchorOffset,r.value.end=l.focusOffset,r.value.x=c.x,r.value.y=c.y+x[0]?.height}}async function B(l){if(a.value==="")return y.value=[],[];let i=a.value.indexOf(":"),f="",x=null;i<0?(f=v.ontologies,x=a.value):(x=a.value.split(":")[1],f=a.value.split(":")[0]);const c=l.currentTarget,m=u.get(c);m&&m.abort();const k=new AbortController;u.set(c,k);const V="https://service.tib.eu/ts4tib/api/select?q=",O=encodeURI("&ontolog-y="+f+"&fieldList=iri,label,short_form,obo_id,ontology_name,ontology_prefix,description,type&obsoletes=false&local=false&rows=10");h.value=!0,(await fetch(`${V}${x}${O}`,{signal:k.signal})).json().then(q=>{u.delete(c),y.value=q.response.docs,h.value=!1})}return(l,i)=>(e.openBlock(),e.createElementBlock("div",{id:"o_annotate_wrapper_"+e.unref(o),class:"o_annotate_wrapper"},[t.label?(e.openBlock(),e.createElementBlock("label",Z,e.toDisplayString(t.label),1)):e.createCommentVNode("",!0),b.value?(e.openBlock(),e.createElementBlock("div",te,[e.createElementVNode("textarea",{ref_key:"o_annotate_textarea",ref:n,onMouseup:w,onKeyup:w,onInput:E,class:"o_annotate_textarea"},e.toDisplayString(e.unref(_)),545)])):(e.openBlock(),e.createElementBlock("div",ee,[e.createElementVNode("div",{onMouseup:w,onKeyup:w,onInput:E,class:"o_annotate_textarea",ref:"o_annotate_div",contenteditable:"true"},e.toDisplayString(e.unref(_)),545)])),e.unref(a)!=""?(e.openBlock(),e.createElementBlock("div",{key:3,class:"contextmenu",style:e.normalizeStyle(e.unref(d))},[e.unref(y).length==0&&!e.unref(h)?(e.openBlock(),e.createElementBlock("div",oe,"No matches found")):(e.openBlock(),e.createElementBlock("div",ne,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(y),f=>(e.openBlock(),e.createElementBlock("div",{class:"contextmenu_item",key:f.short_label,role:"option",tabindex:"_1",aria_selected:"false",aria_setsize:"3",aria_posinset:"0",onClickCapture:e.withModifiers(x=>S(f),["stop","prevent"])},[e.createElementVNode("p",{innerHTML:f.label},null,8,le),e.createElementVNode("small",null,e.toDisplayString(f.ontology_prefix)+":"+e.toDisplayString(f.short_form),1)],40,ae))),128))]))],4)):e.createCommentVNode("",!0),e.createElementVNode("div",null,[e.unref(h)?(e.openBlock(),e.createElementBlock("div",re,se)):e.createCommentVNode("",!0),e.createElementVNode("div",null,[t.info?(e.openBlock(),e.createElementBlock("span",ce,e.toDisplayString(t.info),1)):e.createCommentVNode("",!0)])])],8,Y))}}),de=`.o_annotate_textarea[data-v-bc5db457]{min-height:100px;border:1px solid #d7d7d7;box-shadow:none;box-sizing:border_box;padding:12px 45px 12px 10px;width:100%}#mainInput[data-v-bc5db457]{background:transparent;color:#000;opacity:1}.contextmenu[data-v-bc5db457]{position:absolute;top:0;right:0;background:#ffffff;color:#000;border:1px solid #f1f1f2;width:15rem;max-width:calc(100vw _ 2rem);max-height:300px;overflow-y:scroll;overflow-x:hidden;z-index:100;box-shadow:0 .5rem 1.5rem #0003;border-radius:.2rem}.contextmenu .contextmenu_item[data-v-bc5db457]{border-bottom:1px solid #c3c3c3;padding:8px}.contextmenu .contextmenu_item[data-v-bc5db457]:hover{cursor:pointer;background-color:#f1f1f2}.contextmenu .contextmenu_item p[data-v-bc5db457]{margin:0;padding:0}.contextmenu .contextmenu_item .iri[data-v-bc5db457]{margin:0;width:15rem;white-space:nowrap;text-overflow:ellipsis;word-wrap:break_word;padding:0}
`,pe=$(ue,[["styles",[de]],["__scopeId","data-v-bc5db457"]]),fe={key:0},me=["onKeyup","onChange"],ge={key:1},ve={key:2},he={key:3},ye=e.defineComponent({__name:"ontology-compose.ce",props:{label:{type:String,required:!1,default:""},info:{type:String,required:!1,default:""},placeholder:{type:String,required:!1,default:""},format:{type:String,required:!1,default:"text"}},emits:["change"],setup(t,{emit:g}){const v=t;let o=e.ref(""),n=e.ref(""),b=-1,_=100,r=0,a=e.ref([]),h="",y="",s=!1,u=e.ref([]),d=e.ref([]),p=e.ref(null);const E=e.computed(()=>p.value?p.value?p.value.label+"	"+p.value.ontology_prefix+"	"+p.value.iri+"	"+p.value.type:"":null),S=e.computed(()=>o.value?v.format&&v.format=="json"?{text:o.value,ontology:u.value}:o.value+`
$$$$
`+u.value.join(`
`):null);async function w(c){if(o.value==""){n.value="";return}if(b>-1&&clearTimeout(b),c.key=="ArrowDown"){r==9&&B(),r+=1,x(),c.preventDefault();return}else if(c.key=="ArrowUp"){r==0&&B(),r-=1,x(),c.preventDefault();return}else if(c.key=="ArrowRight")c.preventDefault(),i();else if(o.value){let m=o.value.split(" ");m.length>1?(h=m.slice(-1)[0],y=m.slice(-2).join(" ")):(h=m[0],y=h),h==""&&(s=!1,p.value=null,n.value=o.value),s&&(h=y),l()}}function C(){g("change",S.value)}function B(){s=!0,h=y,r=0,l()}function l(){b=setTimeout(function(){f()},_)}function i(){o.value=n.value,u.value.push(E.value),d.value.push(p.value)}async function f(){const c="https://service.tib.eu/ts4tib/api/select?q=",m=encodeURI("&obsoletes=false&local=false&rows=10");(await fetch(`${c}${h}${m}`)).json().then(V=>{a.value=V.response.docs,a.value.length>0&&(r=0,x())})}function x(){let c="";p.value=a.value[r],c=p.value.label;let m=c.toLowerCase().replace(h,"");m!=null&&(n.value=o.value+m)}return(c,m)=>(e.openBlock(),e.createElementBlock("div",null,[t.label?(e.openBlock(),e.createElementBlock("label",fe,e.toDisplayString(t.label),1)):e.createCommentVNode("",!0),e.createElementVNode("div",null,[e.withDirectives(e.createElementVNode("textarea",{"onUpdate:modelValue":m[0]||(m[0]=k=>e.isRef(n)?n.value=k:n=k),id:"autocomplete",type:"text",class:"o_annotate_textarea",line:"10"},null,512),[[e.vModelText,e.unref(n)]]),e.withDirectives(e.createElementVNode("textarea",{id:"mainInput",onKeyup:e.withModifiers(w,["stop"]),onChange:e.withModifiers(C,["stop"]),"onUpdate:modelValue":m[1]||(m[1]=k=>e.isRef(o)?o.value=k:o=k),type:"text",class:"o_annotate_textarea"},null,40,me),[[e.vModelText,e.unref(o)]])]),t.info&&e.unref(a).length==0?(e.openBlock(),e.createElementBlock("p",ge,e.toDisplayString(t.info),1)):e.createCommentVNode("",!0),e.unref(p)?(e.openBlock(),e.createElementBlock("span",ve,[e.createElementVNode("code",null,[e.createElementVNode("pre",null,e.toDisplayString(e.unref(E)),1)])])):e.createCommentVNode("",!0),e.unref(u)&&e.unref(u).length>0?(e.openBlock(),e.createElementBlock("span",he,[e.createElementVNode("code",null,[e.createElementVNode("pre",null,e.toDisplayString(e.unref(S)),1)])])):e.createCommentVNode("",!0)]))}}),xe=`.o_annotate_textarea[data-v-c52caae7]{min-height:100px;border:1px solid #d7d7d7;box-shadow:none;box-sizing:border-box;padding:12px 45px 12px 10px;width:100%}#mainInput[data-v-c52caae7]{background:transparent;color:#000;opacity:100}#autocomplete[data-v-c52caae7]{position:absolute;box-sizing:border-box;cursor:text;pointer-events:none;color:#000;opacity:.6;background:transparent}
`,be=$(ye,[["styles",[xe]],["__scopeId","data-v-c52caae7"]]),T=e.defineCustomElement(A),N=e.defineCustomElement(Q),D=e.defineCustomElement(pe),M=e.defineCustomElement(be);if(typeof window<"u"){let t=window.customElements;t.define("ontology-annotation",T),t.define("ontology-autocomplete",N),t.define("ontology-annotate",D),t.define("ontology-compose",M)}exports.OntologyAnnotate=D;exports.OntologyAnnotation=T;exports.OntologyAutoComplete=N;exports.OntologyCompose=M;
//# sourceMappingURL=index.cjs.map
