"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const e=require("vue"),O=["href"],M=e.defineComponent({__name:"ontology-annotation.ce",props:{annotation:null},setup(o){const g=o,v=e.computed(()=>g.annotation?g.annotation.split("	")[0]:""),t=e.computed(()=>g.annotation?g.annotation.split("	")[2]:""),a=e.computed(()=>g.annotation?g.annotation.split("	")[1]:"");return(l,w)=>o.annotation&&o.annotation!=""?(e.openBlock(),e.createElementBlock("a",{key:0,href:e.unref(t),target:"_blank"},e.toDisplayString(e.unref(a))+": "+e.toDisplayString(e.unref(v)),9,O)):e.createCommentVNode("",!0)}}),I={class:"auto-search-wrapper"},A={key:0},z=["onInput","placeholder"],L={key:1},R={key:2,class:"auto-results-wrapper auto-is-active"},j={tabindex:"0",role:"listbox"},U=["onClick"],H=["innerHTML"],K=["innerHTML"],P={key:3,type:"button","aria-label":"clear the search query"},W=e.defineComponent({__name:"ontology-autocomplete.ce",props:{label:{type:String,required:!1,default:""},info:{type:String,required:!1,default:""},placeholder:{type:String,required:!1,default:""},ontologies:{type:String,required:!1,default:""},format:{type:String,required:!1,default:"text"}},emits:["change"],setup(o,{emit:g}){const v=o;let t=e.ref(""),a=e.ref([]);async function l(){if(t.value==="")return a.value=[],[];let u=t.value.indexOf(":"),f="",i=null;u<0?(f=v.ontologies,i=t.value):(i=t.value.split(":")[1],f=t.value.split(":")[0]);const d="https://service.tib.eu/ts4tib/api/select?q=",E=encodeURI("&ontology="+f+"&fieldList=iri,label,short_form,obo_id,ontology_name,ontology_prefix,description,type&obsoletes=false&local=false&rows=10");(await fetch(`${d}${i}${E}`)).json().then(n=>{a.value=n.response.docs})}function w(u){return t.value?u.replace(new RegExp(t.value,"gi"),f=>'<span class="highlightText">'+f+"</span>"):u}function s(u){return u?u.join(""):""}let c=e.ref(null);const h=e.computed(()=>c.value?v.format&&v.format=="json"?c.value:c.value?c.value.label+"	"+c.value.ontology_prefix+"	"+c.value.iri+"	"+c.value.type:"":null),r=u=>{c.value=u,t.value=u.label,g("change",h.value),a.value=[]};return(u,f)=>(e.openBlock(),e.createElementBlock("div",I,[o.label?(e.openBlock(),e.createElementBlock("label",A,e.toDisplayString(o.label),1)):e.createCommentVNode("",!0),e.withDirectives(e.createElementVNode("input",{type:"text",id:"search","onUpdate:modelValue":f[0]||(f[0]=i=>e.isRef(t)?t.value=i:t=i),onInput:e.withModifiers(l,["stop"]),placeholder:o.placeholder,autocomplete:"off"},null,40,z),[[e.vModelText,e.unref(t)]]),o.info&&e.unref(a).length==0?(e.openBlock(),e.createElementBlock("p",L,e.toDisplayString(o.info),1)):(e.openBlock(),e.createElementBlock("div",R,[e.createElementVNode("ul",j,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(a),i=>(e.openBlock(),e.createElementBlock("li",{key:i.short_label,role:"option",tabindex:"-1","aria-selected":"false","aria-setsize":"3","aria-posinset":"0",onClick:d=>r(i)},[e.createElementVNode("p",{innerHTML:w(i.label)},null,8,H),e.createElementVNode("p",null,[e.createElementVNode("small",{innerHTML:s(i.description)},null,8,K)]),e.createElementVNode("small",null,e.toDisplayString(i.ontology_prefix)+":"+e.toDisplayString(i.iri),1)],8,U))),128))])])),e.unref(t)!=""&&e.unref(a).length>0?(e.openBlock(),e.createElementBlock("button",P)):e.createCommentVNode("",!0)]))}}),F=`[data-v-d4fc57ea]:root{--close-button: url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath d='M18.984 6.422 13.406 12l5.578 5.578-1.406 1.406L12 13.406l-5.578 5.578-1.406-1.406L10.594 12 5.016 6.422l1.406-1.406L12 10.594l5.578-5.578z'/%3E%3C/svg%3E");--loupe-icon: url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath fill='%23929292' d='M16.041 15.856a.995.995 0 0 0-.186.186A6.97 6.97 0 0 1 11 18c-1.933 0-3.682-.782-4.95-2.05S4 12.933 4 11s.782-3.682 2.05-4.95S9.067 4 11 4s3.682.782 4.95 2.05S18 9.067 18 11a6.971 6.971 0 0 1-1.959 4.856zm5.666 4.437-3.675-3.675A8.967 8.967 0 0 0 20 11c0-2.485-1.008-4.736-2.636-6.364S13.485 2 11 2 6.264 3.008 4.636 4.636 2 8.515 2 11s1.008 4.736 2.636 6.364S8.515 20 11 20a8.967 8.967 0 0 0 5.618-1.968l3.675 3.675a.999.999 0 1 0 1.414-1.414z'/%3E%3C/svg%3E")}.auto-search-wrapper[data-v-d4fc57ea]{display:block;position:relative;width:100%}.auto-search-wrapper p[data-v-d4fc57ea]{margin:0;padding:0;font-size:1.1em}.auto-search-wrapper p .highlightText[data-v-d4fc57ea]{font-weight:700}.auto-search-wrapper input[data-v-d4fc57ea]{border:1px solid #d7d7d7;box-shadow:none;box-sizing:border-box;font-size:16px;padding:12px 45px 12px 10px;width:100%}.auto-search-wrapper input[data-v-d4fc57ea]:focus{border:1px solid #858585;outline:none}.auto-search-wrapper input[data-v-d4fc57ea]::-ms-clear{display:none}.auto-search-wrapper ul[data-v-d4fc57ea]{list-style:none;margin:0;overflow:auto;padding:0}.auto-search-wrapper ul li[data-v-d4fc57ea]{cursor:pointer;margin:0;overflow:hidden;padding:10px;position:relative;border:1px dotted #f1f1f2}.auto-search-wrapper ul li[data-v-d4fc57ea]:hover{background-color:#f1f1f2}.auto-search-wrapper ul li[data-v-d4fc57ea]:not(:last-child){border-top:none}.auto-search-wrapper ul li[disabled][data-v-d4fc57ea]{background:#ececec;opacity:.5;pointer-events:none}.auto-search-wrapper .auto-expanded[data-v-d4fc57ea]{border:1px solid #858585;outline:none}.auto-search-wrapper.loupe[data-v-d4fc57ea]:before{filter:invert(60%)}.auto-is-loading[data-v-d4fc57ea]:after{animation:auto-spinner-d4fc57ea .6s linear infinite;border-color:#d9d9d9 grey grey #d9d9d9;border-radius:50%;border-style:solid;border-width:2px;bottom:0;box-sizing:border-box;content:"";height:20px;margin:auto;position:absolute;right:10px;top:0;width:20px}.auto-is-loading .auto-clear[data-v-d4fc57ea]{display:none}@keyframes auto-spinner-d4fc57ea{to{transform:rotate(1turn)}}li.loupe[data-v-d4fc57ea]:before{bottom:auto;top:15px}.loupe input[data-v-d4fc57ea]{padding:12px 45px 12px 35px}.loupe[data-v-d4fc57ea]:before{background-image:var(--loupe-icon);bottom:0;content:"";height:17px;left:10px;margin:auto;position:absolute;top:0;width:17px}.auto-selected[data-v-d4fc57ea]:before{opacity:1}.auto-clear[data-v-d4fc57ea]{align-items:center;background-color:transparent;border:none;bottom:0;cursor:pointer;display:flex;height:auto;justify-content:center;margin:auto;position:absolute;right:0;top:0;width:40px}.auto-clear[data-v-d4fc57ea]:before{content:var(--close-button);height:24px;line-height:100%;width:24px}.auto-clear span[data-v-d4fc57ea]{display:none}.auto-results-wrapper[data-v-d4fc57ea]{background-color:#fff;border:1px solid #858585;border-top:none;box-sizing:border-box;display:none;overflow:hidden}.auto-results-wrapper ul>.loupe[data-v-d4fc57ea]{padding-left:40px}.auto-results-wrapper.auto-is-active[data-v-d4fc57ea]{display:block;margin-top:-1px;position:absolute;width:100%;z-index:99999}.auto-selected[data-v-d4fc57ea]{background-color:#e6e6e6}.auto-selected+li[data-v-d4fc57ea]:before{border-top:none}.auto-error[data-v-d4fc57ea]{border:1px solid #ff3838}.auto-error[data-v-d4fc57ea]::placeholder{color:#f66;opacity:1}.hidden[data-v-d4fc57ea]{display:none}
`,$=(o,g)=>{const v=o.__vccOpts||o;for(const[t,a]of g)v[t]=a;return v},J=$(W,[["styles",[F]],["__scopeId","data-v-d4fc57ea"]]),G=o=>(e.pushScopeId("data-v-8eeb146b"),o=o(),e.popScopeId(),o),Q={key:0},X={key:0,class:"contextmenu-item"},Y={key:1},Z=["onClickCapture"],ee=["innerHTML"],te={class:"iri"},oe={key:0,style:{float:"right"}},ne=G(()=>e.createElementVNode("i",null,"...loading",-1)),ae=[ne],le={key:0},re=e.defineComponent({__name:"ontology-annotate.ce",props:{label:{type:String,required:!1,default:""},info:{type:String,required:!1,default:""},placeholder:{type:String,required:!1,default:""},ontologies:{type:String,required:!1,default:""},format:{type:String,required:!1,default:"text"}},emits:["change"],setup(o,{emit:g}){const v=o;let t=e.ref("");const a=e.computed(()=>t.value?v.format&&v.format=="json"?{text:t.value,ontology:c}:t.value+`
$$$$
`+c.map(n=>n.ontology.type[0]+"	"+n.ontology.ontology_prefix+" "+n.context.start+" "+n.context.end+"	"+n.ontology.label+"	"+n.ontology.iri).join(`
`):null);let l=e.ref(""),w=e.ref(!1),s=e.ref([]),c=e.reactive([]);const h=new WeakMap;let r=e.ref({x:-1e3,y:0,start:-1,end:-1});function u(n){t.value=n.target.innerText,g("change",a.value)}function f(n){let x={ontology:n,context:r.value};c.push(x),r.value={x:-1e3,y:0,start:-1,end:-1},s.value=[],l.value="",g("change",a.value)}function i(n){if(l.value="",window.getSelection){var x=window.getSelection();console.log(x),l.value=x?.toString(),l.value&&l.value!=""?(s.value=[],r.value={x:-1e3,y:0,start:-1,end:-1},E(x),C(n)):(r.value={x:-1e3,y:0,start:-1,end:-1},s.value=[])}}function d(n){return l.value?n.replace(new RegExp(l.value,"gi"),x=>'<span class="highlightText">'+x+"</span>"):n}function E(n,x=!0){if(!n?.rangeCount)return null;let p=n.getRangeAt(0).cloneRange();if(console.log(p.getClientRects()),!p.getClientRects)return null;p.collapse(x);let b=p.getClientRects();if(b.length<=0)r.value.x=0,r.value.y=0;else{let k=b[0];r.value.start=n.anchorOffset,r.value.end=n.focusOffset,r.value.x=k.x,r.value.y=k.y+b[0]?.height}}async function C(n){if(l.value==="")return s.value=[],[];let x=l.value.indexOf(":"),p="",b=null;x<0?(p=v.ontologies,b=l.value):(b=l.value.split(":")[1],p=l.value.split(":")[0]);const k=n.currentTarget,B=h.get(k);B&&B.abort();const S=new AbortController;h.set(k,S);const y="https://service.tib.eu/ts4tib/api/select?q=",m=encodeURI("&ontology="+p+"&fieldList=iri,label,short_form,obo_id,ontology_name,ontology_prefix,description,type&obsoletes=false&local=false&rows=10");w.value=!0,(await fetch(`${y}${b}${m}`,{signal:S.signal})).json().then(V=>{h.delete(k),s.value=V.response.docs,w.value=!1})}return(n,x)=>(e.openBlock(),e.createElementBlock("div",null,[o.label?(e.openBlock(),e.createElementBlock("label",Q,e.toDisplayString(o.label),1)):e.createCommentVNode("",!0),e.createElementVNode("div",null,[e.createElementVNode("div",{onMouseup:i,onKeyup:i,onInput:u,class:"vc_textarea",contenteditable:"true"},e.toDisplayString(e.unref(t)),33),e.createElementVNode("div",{class:"contextmenu",style:e.normalizeStyle("left:"+e.unref(r).x+"px; top:"+e.unref(r).y+"px")},[e.unref(s).length==0&&!e.unref(w)?(e.openBlock(),e.createElementBlock("div",X,"No matches found")):(e.openBlock(),e.createElementBlock("div",Y,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(s),p=>(e.openBlock(),e.createElementBlock("div",{class:"contextmenu-item",key:p.short_label,role:"option",tabindex:"-1","aria-selected":"false","aria-setsize":"3","aria-posinset":"0",onClickCapture:e.withModifiers(b=>f(p),["stop","prevent"])},[e.createElementVNode("p",{innerHTML:d(p.label)},null,8,ee),e.createElementVNode("small",te,e.toDisplayString(p.ontology_prefix)+":"+e.toDisplayString(p.iri),1)],40,Z))),128))]))],4)]),e.createElementVNode("div",null,[e.unref(w)?(e.openBlock(),e.createElementBlock("div",oe,ae)):e.createCommentVNode("",!0),e.createElementVNode("div",null,[o.info?(e.openBlock(),e.createElementBlock("span",le,e.toDisplayString(o.info),1)):e.createCommentVNode("",!0)])])]))}}),ie=`.vc_textarea[data-v-8eeb146b]{min-height:100px;border:1px solid #d7d7d7;box-shadow:none;box-sizing:border-box;padding:12px 45px 12px 10px;width:100%}#mainInput[data-v-8eeb146b]{background:transparent;color:#000;opacity:1}.contextmenu[data-v-8eeb146b]{position:absolute;background:#ffffff;color:#000;margin-top:5px;border:1px solid #f1f1f2;box-shadow:0 .5rem 1.5rem #0003;border-radius:.2rem;width:15rem;max-width:calc(100vw - 2rem);max-height:300px;overflow-y:scroll;overflow-x:hidden;z-index:100}.contextmenu .contextmenu-item[data-v-8eeb146b]{border-bottom:1px solid #c3c3c3;padding:8px}.contextmenu .contextmenu-item[data-v-8eeb146b]:hover{cursor:pointer;background-color:#f1f1f2}.contextmenu .contextmenu-item p[data-v-8eeb146b]{margin:0;padding:0}.contextmenu .contextmenu-item .iri[data-v-8eeb146b]{margin:0;width:15rem;white-space:nowrap;text-overflow:ellipsis;word-wrap:break-word;padding:0}
`,se=$(re,[["styles",[ie]],["__scopeId","data-v-8eeb146b"]]),ce={key:0},ue=["onKeyup","onChange"],de={key:1},pe={key:2},fe={key:3},me=e.defineComponent({__name:"ontology-compose.ce",props:{label:{type:String,required:!1,default:""},info:{type:String,required:!1,default:""},placeholder:{type:String,required:!1,default:""},format:{type:String,required:!1,default:"text"}},emits:["change"],setup(o,{emit:g}){const v=o;let t=e.ref(""),a=e.ref(""),l=-1,w=100,s=0,c=e.ref([]),h="",r="",u=!1,f=e.ref([]),i=e.ref([]),d=e.ref(null);const E=e.computed(()=>d.value?d.value?d.value.label+"	"+d.value.ontology_prefix+"	"+d.value.iri+"	"+d.value.type:"":null),C=e.computed(()=>t.value?v.format&&v.format=="json"?{text:t.value,ontology:f.value}:t.value+`
$$$$
`+f.value.join(`
`):null);async function n(y){if(t.value==""){a.value="";return}if(l>-1&&clearTimeout(l),y.key=="ArrowDown"){s==9&&p(),s+=1,S(),y.preventDefault();return}else if(y.key=="ArrowUp"){s==0&&p(),s-=1,S(),y.preventDefault();return}else if(y.key=="ArrowRight")y.preventDefault(),k();else if(t.value){let m=t.value.split(" ");m.length>1?(h=m.slice(-1)[0],r=m.slice(-2).join(" ")):(h=m[0],r=h),h==""&&(u=!1,d.value=null,a.value=t.value),u&&(h=r),b()}}function x(){g("change",C.value)}function p(){u=!0,h=r,s=0,b()}function b(){l=setTimeout(function(){B()},w)}function k(){t.value=a.value,f.value.push(E.value),i.value.push(d.value)}async function B(){const y="https://service.tib.eu/ts4tib/api/select?q=",m=encodeURI("&obsoletes=false&local=false&rows=10");(await fetch(`${y}${h}${m}`)).json().then(V=>{c.value=V.response.docs,c.value.length>0&&(s=0,S())})}function S(){let y="";if(d.value){d.value=c.value[s],y=d.value.label;let m=y.toLowerCase().replace(h,"");m!=null&&(a.value=t.value+m)}}return(y,m)=>(e.openBlock(),e.createElementBlock("div",null,[o.label?(e.openBlock(),e.createElementBlock("label",ce,e.toDisplayString(o.label),1)):e.createCommentVNode("",!0),e.createElementVNode("div",null,[e.withDirectives(e.createElementVNode("textarea",{"onUpdate:modelValue":m[0]||(m[0]=_=>e.isRef(a)?a.value=_:a=_),id:"autocomplete",type:"text",class:"vc_textarea",line:"10"},null,512),[[e.vModelText,e.unref(a)]]),e.withDirectives(e.createElementVNode("textarea",{id:"mainInput",onKeyup:e.withModifiers(n,["stop"]),onChange:e.withModifiers(x,["stop"]),"onUpdate:modelValue":m[1]||(m[1]=_=>e.isRef(t)?t.value=_:t=_),type:"text",class:"vc_textarea"},null,40,ue),[[e.vModelText,e.unref(t)]])]),o.info&&e.unref(c).length==0?(e.openBlock(),e.createElementBlock("p",de,e.toDisplayString(o.info),1)):e.createCommentVNode("",!0),e.unref(d)?(e.openBlock(),e.createElementBlock("span",pe,[e.createElementVNode("code",null,[e.createElementVNode("pre",null,e.toDisplayString(e.unref(E)),1)])])):e.createCommentVNode("",!0),e.unref(f)&&e.unref(f).length>0?(e.openBlock(),e.createElementBlock("span",fe,[e.createElementVNode("code",null,[e.createElementVNode("pre",null,e.toDisplayString(e.unref(C)),1)])])):e.createCommentVNode("",!0)]))}}),ge=`.vc_textarea[data-v-8694d5ed]{min-height:100px;border:1px solid #d7d7d7;box-shadow:none;box-sizing:border-box;padding:12px 45px 12px 10px;width:100%}#mainInput[data-v-8694d5ed]{background:transparent;color:#000;opacity:100}#autocomplete[data-v-8694d5ed]{position:absolute;box-sizing:border-box;cursor:text;pointer-events:none;color:#000;opacity:.6;background:transparent}
`,ve=$(me,[["styles",[ge]],["__scopeId","data-v-8694d5ed"]]),T=e.defineCustomElement(M),N=e.defineCustomElement(J),D=e.defineCustomElement(se),q=e.defineCustomElement(ve);customElements.define("ontology-annotation",T);customElements.define("ontology-autocomplete",N);customElements.define("ontology-annotate",D);customElements.define("ontology-compose",q);exports.OntologyAnnotate=D;exports.OntologyAnnotation=T;exports.OntologyAutoComplete=N;exports.OntologyCompose=q;
//# sourceMappingURL=index.cjs.map
