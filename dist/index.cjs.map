{"version":3,"file":"index.cjs","sources":["../src/components/ontology-annotation.ce.vue","../src/components/ontology-autocomplete.ce.vue","../src/components/ontology-annotate.ce.vue","../src/components/ontology-compose.ce.vue","../src/OntologyElements.js"],"sourcesContent":["<script lang=\"ts\" setup>\nimport { computed } from 'vue'\n\nconst props = defineProps<{\n  annotation?: string\n}>()\n\nconst term = computed(() => {\n  return props.annotation ? props.annotation.split('\\t')[0] : ''\n})\nconst iri = computed(() => {\n  return props.annotation ? props.annotation.split('\\t')[2] : ''\n})\nconst source = computed(() => {\n  return props.annotation ? props.annotation.split('\\t')[1] : ''\n})\n</script>\n<template>\n  <a v-if=\"annotation && annotation != ''\" :href=\"iri\" target=\"_blank\">\n    {{ source }}: {{ term }}\n  </a>\n</template>\n","<template>\n  <div class=\"auto-search-wrapper\">\n    <label v-if=\"label\">{{ label }}</label>\n    <input\n      type=\"text\"\n      id=\"search\"\n      v-model=\"searchTerm\"\n      @input.stop=\"getSelectOptions\"\n      :placeholder=\"placeholder\"\n      autocomplete=\"off\"\n    />\n    <p v-if=\"info && matches.length == 0\">{{ info }}</p>\n    <div v-else class=\"auto-results-wrapper auto-is-active\">\n      <ul tabindex=\"0\" role=\"listbox\">\n        <li\n          v-for=\"doc in matches\"\n          :key=\"doc['short_label']\"\n          role=\"option\"\n          tabindex=\"-1\"\n          aria-selected=\"false\"\n          aria-setsize=\"3\"\n          aria-posinset=\"0\"\n          @click=\"selectTerm(doc)\"\n        >\n          <p v-html=\"highlight(doc['label'])\"></p>\n          <p><small v-html=\"concat(doc['description'])\"></small></p>\n          <small>{{ doc['ontology_prefix'] }}:{{ doc['iri'] }}</small>\n        </li>\n      </ul>\n    </div>\n    <button\n      v-if=\"searchTerm != '' && matches.length > 0\"\n      type=\"button\"\n      aria-label=\"clear the search query\"\n    ></button>\n  </div>\n</template>\n\n<script lang=\"ts\" setup>\nimport { ref, computed } from 'vue'\n\nconst props = defineProps({\n  label: {\n    type: String,\n    required: false,\n    default: ''\n  },\n  info: {\n    type: String,\n    required: false,\n    default: ''\n  },\n  placeholder: {\n    type: String,\n    required: false,\n    default: ''\n  },\n  ontologies: {\n    type: String,\n    required: false,\n    default: ''\n  },\n  format: {\n    type: String,\n    required: false,\n    default: 'text'\n  }\n})\n\nlet searchTerm = ref('')\n\nconst emit = defineEmits(['change'])\n\nlet matches = ref([])\n\nasync function getSelectOptions() {\n  if (searchTerm.value === '') {\n    matches.value = []\n    return []\n  }\n  let ontologiesExists = searchTerm.value.indexOf(':')\n  let ontologies = ''\n  let term = null\n  if (ontologiesExists < 0) {\n    ontologies = props.ontologies\n    term = searchTerm.value\n  } else {\n    term = searchTerm.value.split(':')[1]\n    ontologies = searchTerm.value.split(':')[0]\n  }\n\n  const url = 'https://service.tib.eu/ts4tib/api/select?q='\n  const queries = encodeURI(\n    '&ontology=' +\n      ontologies +\n      '&fieldList=iri,label,short_form,obo_id,ontology_name,ontology_prefix,description,type&obsoletes=false&local=false&rows=10'\n  )\n\n  let response = (await fetch(`${url}${term}${queries}`)).json()\n  response.then((body) => {\n    matches.value = body.response.docs\n  })\n}\n\nfunction highlight(content: string) {\n  if (!searchTerm.value) {\n    return content\n  }\n  return content.replace(new RegExp(searchTerm.value, 'gi'), (match) => {\n    return '<span class=\"highlightText\">' + match + '</span>'\n  })\n}\n\nfunction concat(data: Array<[]>) {\n  return data ? data.join('') : ''\n}\n\nlet selectedTerm = ref(null)\n\nconst selectedValue = computed(() => {\n  if (!selectedTerm.value) {\n    return null\n  }\n  if (props.format && props.format == 'json') {\n    return selectedTerm.value\n  } else {\n    return selectedTerm.value\n      ? selectedTerm.value['label'] +\n          '\\t' +\n          selectedTerm.value['ontology_prefix'] +\n          '\\t' +\n          selectedTerm.value['iri'] +\n          '\\t' +\n          selectedTerm.value['type']\n      : ''\n  }\n})\n\nconst selectTerm = (term: any) => {\n  selectedTerm.value = term\n  searchTerm.value = term.label\n  emit('change', selectedValue.value)\n  matches.value = []\n}\n</script>\n\n<style scoped>\n:root {\n  --close-button: url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath d='M18.984 6.422 13.406 12l5.578 5.578-1.406 1.406L12 13.406l-5.578 5.578-1.406-1.406L10.594 12 5.016 6.422l1.406-1.406L12 10.594l5.578-5.578z'/%3E%3C/svg%3E\");\n  --loupe-icon: url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath fill='%23929292' d='M16.041 15.856a.995.995 0 0 0-.186.186A6.97 6.97 0 0 1 11 18c-1.933 0-3.682-.782-4.95-2.05S4 12.933 4 11s.782-3.682 2.05-4.95S9.067 4 11 4s3.682.782 4.95 2.05S18 9.067 18 11a6.971 6.971 0 0 1-1.959 4.856zm5.666 4.437-3.675-3.675A8.967 8.967 0 0 0 20 11c0-2.485-1.008-4.736-2.636-6.364S13.485 2 11 2 6.264 3.008 4.636 4.636 2 8.515 2 11s1.008 4.736 2.636 6.364S8.515 20 11 20a8.967 8.967 0 0 0 5.618-1.968l3.675 3.675a.999.999 0 1 0 1.414-1.414z'/%3E%3C/svg%3E\");\n}\n\n.auto-search-wrapper {\n  display: block;\n  position: relative;\n  width: 100%;\n}\n\n.auto-search-wrapper p {\n  margin: 0;\n  padding: 0;\n  font-size: 1.1em;\n}\n\n.auto-search-wrapper p .highlightText {\n  font-weight: bold;\n}\n\n.auto-search-wrapper input {\n  border: 1px solid #d7d7d7;\n  box-shadow: none;\n  box-sizing: border-box;\n  font-size: 16px;\n  padding: 12px 45px 12px 10px;\n  width: 100%;\n}\n\n.auto-search-wrapper input:focus {\n  border: 1px solid #858585;\n  outline: none;\n}\n\n.auto-search-wrapper input::-ms-clear {\n  display: none;\n}\n\n.auto-search-wrapper ul {\n  list-style: none;\n  margin: 0;\n  overflow: auto;\n  padding: 0;\n}\n\n.auto-search-wrapper ul li {\n  cursor: pointer;\n  margin: 0;\n  overflow: hidden;\n  padding: 10px;\n  position: relative;\n  border: 1px dotted #f1f1f2;\n}\n\n.auto-search-wrapper ul li:hover {\n  background-color: #f1f1f2;\n}\n\n.auto-search-wrapper ul li:not(:last-child) {\n  border-top: none;\n}\n\n.auto-search-wrapper ul li[disabled] {\n  background: #ececec;\n  opacity: 0.5;\n  pointer-events: none;\n}\n\n.auto-search-wrapper .auto-expanded {\n  border: 1px solid #858585;\n  outline: none;\n}\n\n.auto-search-wrapper.loupe:before {\n  filter: invert(60%);\n}\n\n.auto-is-loading:after {\n  animation: auto-spinner 0.6s linear infinite;\n  border-color: #d9d9d9 grey grey #d9d9d9;\n  border-radius: 50%;\n  border-style: solid;\n  border-width: 2px;\n  bottom: 0;\n  box-sizing: border-box;\n  content: '';\n  height: 20px;\n  margin: auto;\n  position: absolute;\n  right: 10px;\n  top: 0;\n  width: 20px;\n}\n\n.auto-is-loading .auto-clear {\n  display: none;\n}\n\n@keyframes auto-spinner {\n  to {\n    transform: rotate(1turn);\n  }\n}\n\nli.loupe:before {\n  bottom: auto;\n  top: 15px;\n}\n\n.loupe input {\n  padding: 12px 45px 12px 35px;\n}\n\n.loupe:before {\n  background-image: var(--loupe-icon);\n  bottom: 0;\n  content: '';\n  height: 17px;\n  left: 10px;\n  margin: auto;\n  position: absolute;\n  top: 0;\n  width: 17px;\n}\n\n.auto-selected:before {\n  opacity: 1;\n}\n\n.auto-clear {\n  align-items: center;\n  background-color: transparent;\n  border: none;\n  bottom: 0;\n  cursor: pointer;\n  display: flex;\n  height: auto;\n  justify-content: center;\n  margin: auto;\n  position: absolute;\n  right: 0;\n  top: 0;\n  width: 40px;\n}\n\n.auto-clear:before {\n  content: var(--close-button);\n  height: 24px;\n  line-height: 100%;\n  width: 24px;\n}\n\n.auto-clear span {\n  display: none;\n}\n\n.auto-results-wrapper {\n  background-color: #fff;\n  border: 1px solid #858585;\n  border-top: none;\n  box-sizing: border-box;\n  display: none;\n  overflow: hidden;\n}\n\n.auto-results-wrapper ul > .loupe {\n  padding-left: 40px;\n}\n\n.auto-results-wrapper.auto-is-active {\n  display: block;\n  margin-top: -1px;\n  position: absolute;\n  width: 100%;\n  z-index: 99999;\n}\n\n.auto-selected {\n  background-color: #e6e6e6;\n}\n\n.auto-selected + li:before {\n  border-top: none;\n}\n\n.auto-error {\n  border: 1px solid #ff3838;\n}\n\n.auto-error::placeholder {\n  color: #f66;\n  opacity: 1;\n}\n\n.hidden {\n  display: none;\n}\n</style>\n","<template>\n  <div :id=\"'o_annotate_wrapper_' + reference\" class=\"o_annotate_wrapper\">\n    <label class=\"o_annotate_label\" v-if=\"label\">{{ label }}</label>\n    <div v-if=\"!hasShadowDOM\">\n      <div\n        @mouseup=\"checkSelection\"\n        @keyup=\"checkSelection\"\n        @input=\"onInput\"\n        class=\"o_annotate_textarea\"\n        ref=\"o_annotate_div\"\n        contenteditable=\"true\"\n      >\n        {{ content }}\n      </div>\n    </div>\n    <div v-else>\n      <textarea\n        ref=\"o_annotate_textarea\"\n        @mouseup=\"checkSelection\"\n        @keyup=\"checkSelection\"\n        @input=\"onInput\"\n        class=\"o_annotate_textarea\"\n        >{{ content }}</textarea\n      >\n    </div>\n    <div v-if=\"searchTerm != ''\" class=\"contextmenu\" :style=\"context_menu_styling\">\n      <div class=\"contextmenu_item\" v-if=\"matches.length == 0 && !loading\">No matches found</div>\n      <div v-else>\n        <div\n          class=\"contextmenu_item\"\n          v-for=\"doc in matches\"\n          :key=\"doc['short_label']\"\n          role=\"option\"\n          tabindex=\"_1\"\n          aria_selected=\"false\"\n          aria_setsize=\"3\"\n          aria_posinset=\"0\"\n          @click.capture.stop.prevent=\"selectTerm(doc)\"\n        >\n          <p v-html=\"doc['label']\"></p>\n          <small>{{ doc['ontology_prefix'] }}:{{ doc['short_form'] }}</small>\n        </div>\n      </div>\n    </div>\n    <div>\n      <div v-if=\"loading\" style=\"float: right\">\n        <i>...loading</i>\n      </div>\n      <div>\n        <span v-if=\"info\">{{ info }}</span>\n      </div>\n    </div>\n  </div>\n</template>\n<script lang=\"ts\" setup>\nimport { ref, computed, reactive, onMounted, type HtmlHTMLAttributes } from 'vue'\n\nconst reference = (Math.random() + 1).toString(36).substring(7)\nconst o_annotate_textarea = ref<HTMLTextAreaElement | null>(null)\nconst hasShadowDOM = ref(false)\nconst emit = defineEmits(['change'])\nlet content = ref('')\nlet cords: any = ref({ x: -1000, y: 0, start: -1, end: -1 })\nlet searchTerm = ref('')\nlet loading = ref(false)\nlet matches = ref([])\ntype OntologyType = {\n  ontology: any\n  context: any\n}\nlet selectedTerms: Array<OntologyType> = reactive([])\nconst pendingRequests = new WeakMap()\nconst props = defineProps({\n  label: {\n    type: String,\n    required: false,\n    default: ''\n  },\n  info: {\n    type: String,\n    required: false,\n    default: ''\n  },\n  placeholder: {\n    type: String,\n    required: false,\n    default: ''\n  },\n  ontologies: {\n    type: String,\n    required: false,\n    default: ''\n  },\n  format: {\n    type: String,\n    required: false,\n    default: 'text'\n  }\n})\n\nconst context_menu_styling = computed(() => {\n  return 'left:' + cords.value.x + 'px; top:' + cords.value.y + 'px'\n})\n\nconst bratOnto = computed(() => {\n  let _content = hasShadowDOM ? o_annotate_textarea.value?.value : content.value\n  if (!_content) {\n    return null\n  }\n  if (props.format && props.format == 'json') {\n    return {\n      text: _content,\n      ontology: selectedTerms\n    }\n  } else {\n    return (\n      _content +\n      '\\n$$$$\\n' +\n      selectedTerms\n        .map(\n          (t) =>\n            t.ontology['type'][0] +\n            '\\t' +\n            t.ontology['ontology_prefix'] +\n            ' ' +\n            t.context['start'] +\n            ' ' +\n            t.context['end'] +\n            '\\t' +\n            t.ontology['label'] +\n            '\\t' +\n            t.ontology['iri']\n        )\n        .join('\\n')\n    )\n  }\n})\n\nonMounted(() => {\n  var el = document.getElementsByTagName('ontology-annotate')[0]\n  if (!!el?.shadowRoot) {\n    hasShadowDOM.value = true\n  }\n})\n\nfunction onInput(e: any) {\n  content.value = e.target.innerText\n  emit('change', bratOnto.value)\n}\n\nfunction selectTerm(doc: any) {\n  let data = {\n    ontology: {},\n    context: {}\n  }\n  if (!hasShadowDOM) {\n    data = { ontology: doc, context: cords.value }\n  } else {\n    if(o_annotate_textarea){\n      let _cords = { x: 0, y: 0, start: o_annotate_textarea.value?.selectionStart, end: o_annotate_textarea.value?.selectionEnd }\n      data = { ontology: doc, context: _cords }\n    }\n  }\n  selectedTerms.push(data)\n  matches.value = []\n  searchTerm.value = ''\n  emit('change', bratOnto.value)\n}\n\nfunction checkSelection(e: any) {\n  searchTerm.value = ''\n  if (window.getSelection) {\n    var selection = window.getSelection()\n    searchTerm.value = selection?.toString()!\n    if (searchTerm.value && searchTerm.value != '') {\n      matches.value = []\n      getSelectionCoords(selection)\n      getSelectOptions(e)\n    } else {\n      cords.value = { x: -1000, y: 0, start: -1, end: -1 }\n      matches.value = []\n    }\n  }\n}\n\nfunction getSelectionCoords(sel: any, atStart: boolean = true) {\n  if (!sel?.rangeCount) return null\n  let range = sel.getRangeAt(0).cloneRange()\n  if (!range.getClientRects) return null\n  range.collapse(atStart)\n  let rects = range.getClientRects()\n  if (rects.length <= 0) {\n    cords.value.x = 0\n    cords.value.y = 0\n  } else {\n    let rect = rects[0]\n    cords.value.start = sel.anchorOffset\n    cords.value.end = sel.focusOffset\n    cords.value.x = rect.x\n    cords.value.y = rect.y + rects[0]?.height\n  }\n}\n\nasync function getSelectOptions(event: any) {\n  if (searchTerm.value === '') {\n    matches.value = []\n    return []\n  }\n  let ontologiesExists = searchTerm.value.indexOf(':')\n  let ontologies = ''\n  let term = null\n  if (ontologiesExists < 0) {\n    ontologies = props.ontologies\n    term = searchTerm.value\n  } else {\n    term = searchTerm.value.split(':')[1]\n    ontologies = searchTerm.value.split(':')[0]\n  }\n\n  const ele = event.currentTarget\n  const previousController = pendingRequests.get(ele)\n\n  if (previousController) {\n    previousController.abort()\n  }\n\n  const controller = new AbortController()\n  pendingRequests.set(ele, controller)\n\n  const url = 'https://service.tib.eu/ts4tib/api/select?q='\n  const queries = encodeURI(\n    '&ontolog-y=' +\n      ontologies +\n      '&fieldList=iri,label,short_form,obo_id,ontology_name,ontology_prefix,description,type&obsoletes=false&local=false&rows=10'\n  )\n\n  loading.value = true\n\n  let response = (await fetch(`${url}${term}${queries}`, { signal: controller.signal })).json()\n\n  response.then((body) => {\n    pendingRequests.delete(ele)\n    matches.value = body.response.docs\n    loading.value = false\n  })\n}\n</script>\n<style scoped>\n.o_annotate_textarea {\n  min-height: 100px;\n  width: 100%;\n  border: 1px solid #d7d7d7;\n  box-shadow: none;\n  box-sizing: border_box;\n  padding: 12px 45px 12px 10px;\n  width: 100%;\n}\n\n#mainInput {\n  background: transparent;\n  color: black;\n  opacity: 1;\n}\n\n.contextmenu {\n  position: absolute;\n  top: 0;\n  right: 0;\n  background: #ffffff;\n  color: #000;\n  border: 1px solid #f1f1f2;\n  width: 15rem;\n  max-width: calc(100vw _ 2rem);\n  max-height: 300px;\n  overflow-y: scroll;\n  overflow-x: hidden;\n  z-index: 100;\n  box-shadow: 0 0.5rem 1.5rem rgba(0, 0, 0, 0.2);\n  border-radius: 0.2rem;\n}\n\n.contextmenu .contextmenu_item {\n  border-bottom: 1px solid #c3c3c3;\n  padding: 8px;\n}\n\n.contextmenu .contextmenu_item:hover {\n  cursor: pointer;\n  background-color: #f1f1f2;\n}\n\n.contextmenu .contextmenu_item p {\n  margin: 0;\n  padding: 0;\n}\n\n.contextmenu .contextmenu_item .iri {\n  margin: 0;\n  width: 15rem;\n  white-space: nowrap;\n  text-overflow: ellipsis;\n  word-wrap: break_word;\n  padding: 0;\n}\n</style>\n","<template>\n  <div>\n    <label v-if=\"label\">{{ label }}</label>\n    <div>\n      <textarea\n        v-model=\"autocompleteText\"\n        id=\"autocomplete\"\n        type=\"text\"\n        class=\"vc_textarea\"\n        line=\"10\"\n      ></textarea>\n      <textarea\n        id=\"mainInput\"\n        @keyup.stop=\"processInput\"\n        @change.stop=\"propogateData\"\n        v-model=\"inputText\"\n        type=\"text\"\n        class=\"vc_textarea\"\n      ></textarea>\n    </div>\n    <p v-if=\"info && matches.length == 0\">{{ info }}</p>\n    <span v-if=\"currentMatchedOntologyTerm\">\n      <code>\n        <pre>{{ currentMatchedOntologyTermValue }}</pre>\n      </code>\n    </span>\n    <span v-if=\"annotatedTerms && annotatedTerms.length > 0\">\n      <code>\n        <pre>{{ bratOnto }}</pre>\n      </code>\n    </span>\n  </div>\n</template>\n\n<script lang=\"ts\" setup>\nimport { ref, computed } from 'vue'\n\nconst props = defineProps({\n  label: {\n    type: String,\n    required: false,\n    default: ''\n  },\n  info: {\n    type: String,\n    required: false,\n    default: ''\n  },\n  placeholder: {\n    type: String,\n    required: false,\n    default: ''\n  },\n  format: {\n    type: String,\n    required: false,\n    default: 'text'\n  }\n})\n\nlet inputText = ref('')\nlet autocompleteText = ref('')\nlet typingTimer = -1\nlet doneTypingInterval = 100\nlet currentMatchIndex = 0\nlet matches = ref([])\nlet lastW = ''\nlet last2W = ''\nlet queryLastTwoTerms = false\nlet annotatedTerms: any = ref([])\nlet annotatedTermsJSON: any = ref([])\nlet currentMatchedOntologyTerm: any = ref(null)\n\nconst currentMatchedOntologyTermValue = computed(() => {\n  if (!currentMatchedOntologyTerm.value) {\n    return null\n  }\n\n  return currentMatchedOntologyTerm.value\n    ? currentMatchedOntologyTerm.value['label'] +\n        '\\t' +\n        currentMatchedOntologyTerm.value['ontology_prefix'] +\n        '\\t' +\n        currentMatchedOntologyTerm.value['iri'] +\n        '\\t' +\n        currentMatchedOntologyTerm.value['type']\n    : ''\n})\n\nconst emit = defineEmits(['change'])\n\nconst bratOnto = computed(() => {\n  if (!inputText.value) {\n    return null\n  }\n  if (props.format && props.format == 'json') {\n    return {\n      text: inputText.value,\n      ontology: annotatedTerms.value\n    }\n  } else {\n    return inputText.value + '\\n$$$$\\n' + annotatedTerms.value.join('\\n')\n  }\n})\n\nasync function processInput(e: any) {\n  if (inputText.value == '') {\n    autocompleteText.value = ''\n    return\n  }\n\n  if (typingTimer > -1) {\n    clearTimeout(typingTimer)\n  }\n\n  if (e.key == 'ArrowDown') {\n    if (currentMatchIndex == 9) {\n      reset()\n    }\n    currentMatchIndex += 1\n    updateAutoCompleteText()\n    e.preventDefault()\n    return\n  } else if (e.key == 'ArrowUp') {\n    if (currentMatchIndex == 0) {\n      reset()\n    }\n    currentMatchIndex -= 1\n    updateAutoCompleteText()\n    e.preventDefault()\n    return\n  } else if (e.key == 'ArrowRight') {\n    e.preventDefault()\n    tabkeyPressed()\n  } else {\n    if (inputText.value) {\n      let wordsArray = inputText.value.split(' ')\n      if (wordsArray.length > 1) {\n        lastW = wordsArray.slice(-1)[0]\n        last2W = wordsArray.slice(-2).join(' ')\n      } else {\n        lastW = wordsArray[0]\n        last2W = lastW\n      }\n      if (lastW == '') {\n        queryLastTwoTerms = false\n        currentMatchedOntologyTerm.value = null\n        autocompleteText.value = inputText.value\n      }\n      if (queryLastTwoTerms) {\n        lastW = last2W\n      }\n      searchDB()\n    }\n  }\n}\n\nfunction propogateData() {\n  emit('change', bratOnto.value)\n}\n\nfunction reset() {\n  queryLastTwoTerms = true\n  lastW = last2W\n  currentMatchIndex = 0\n  searchDB()\n}\n\nfunction searchDB() {\n  typingTimer = setTimeout(function () {\n    CallMLDataSetAPI()\n  }, doneTypingInterval)\n}\n\nfunction tabkeyPressed() {\n  inputText.value = autocompleteText.value\n  annotatedTerms.value.push(currentMatchedOntologyTermValue.value)\n  annotatedTermsJSON.value.push(currentMatchedOntologyTerm.value)\n}\n\nasync function CallMLDataSetAPI() {\n  //call api and get response\n  const url = 'https://service.tib.eu/ts4tib/api/select?q='\n  const queries = encodeURI('&obsoletes=false&local=false&rows=10')\n\n  let response = (await fetch(`${url}${lastW}${queries}`)).json()\n  response.then((body) => {\n    matches.value = body.response.docs\n    if (matches.value.length > 0) {\n      currentMatchIndex = 0\n      updateAutoCompleteText()\n    }\n  })\n}\n\nfunction updateAutoCompleteText() {\n  let matchedTerm = ''\n  if (currentMatchedOntologyTerm.value) {\n    currentMatchedOntologyTerm.value = matches.value[currentMatchIndex]\n    matchedTerm = currentMatchedOntologyTerm.value['label']\n    let term = matchedTerm.toLowerCase().replace(lastW, '')\n    if (term != undefined) {\n      autocompleteText.value = inputText.value + term\n    }\n  }\n}\n</script>\n<style scoped>\n.vc_textarea {\n  min-height: 100px;\n  width: 100%;\n  border: 1px solid #d7d7d7;\n  box-shadow: none;\n  box-sizing: border-box;\n  padding: 12px 45px 12px 10px;\n  width: 100%;\n}\n\n#mainInput {\n  background: transparent;\n  color: black;\n  opacity: 100;\n}\n\n#autocomplete {\n  opacity: 0.6;\n  background: transparent;\n  position: absolute;\n  box-sizing: border-box;\n  cursor: text;\n  pointer-events: none;\n  color: black;\n  opacity: 0.6;\n  background: transparent;\n}\n</style>\n","import { defineCustomElement } from 'vue'\nimport VueOntologyAnnotation from './components/ontology-annotation.ce.vue'\nimport VueOntologyAutoComplete from './components/ontology-autocomplete.ce.vue'\nimport VueOntologyAnnotate from './components/ontology-annotate.ce.vue'\nimport VueOntologyCompose from './components/ontology-compose.ce.vue'\n\nexport const OntologyAnnotation = defineCustomElement(VueOntologyAnnotation)\nexport const OntologyAutoComplete = defineCustomElement(VueOntologyAutoComplete)\nexport const OntologyAnnotate = defineCustomElement(VueOntologyAnnotate)\nexport const OntologyCompose = defineCustomElement(VueOntologyCompose)\n\nif (typeof window !== \"undefined\") {\n    let customElementRegistry = window.customElements;\n\n    customElementRegistry.define('ontology-annotation', OntologyAnnotation)\n    customElementRegistry.define('ontology-autocomplete', OntologyAutoComplete)\n    customElementRegistry.define('ontology-annotate', OntologyAnnotate)\n    customElementRegistry.define('ontology-compose', OntologyCompose)\n}\n"],"names":["term","computed","props","iri","source","searchTerm","ref","matches","getSelectOptions","ontologiesExists","ontologies","url","queries","body","highlight","content","match","concat","data","selectedTerm","selectedValue","selectTerm","emit","reference","o_annotate_textarea","hasShadowDOM","cords","loading","selectedTerms","reactive","pendingRequests","context_menu_styling","bratOnto","_content","t","onMounted","el","onInput","e","doc","_cords","checkSelection","selection","getSelectionCoords","sel","atStart","range","rects","rect","event","ele","previousController","controller","inputText","autocompleteText","typingTimer","doneTypingInterval","currentMatchIndex","lastW","last2W","queryLastTwoTerms","annotatedTerms","annotatedTermsJSON","currentMatchedOntologyTerm","currentMatchedOntologyTermValue","processInput","reset","updateAutoCompleteText","tabkeyPressed","wordsArray","searchDB","propogateData","CallMLDataSetAPI","matchedTerm","OntologyAnnotation","defineCustomElement","VueOntologyAnnotation","OntologyAutoComplete","VueOntologyAutoComplete","OntologyAnnotate","VueOntologyAnnotate","OntologyCompose","VueOntologyCompose","customElementRegistry"],"mappings":"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"}